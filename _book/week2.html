<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Week 2 | CSDE 502 Winter 2021</title>
  <meta name="description" content="These are the class notes and assignments for CSDE 502." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Week 2 | CSDE 502 Winter 2021" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the class notes and assignments for CSDE 502." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Week 2 | CSDE 502 Winter 2021" />
  
  <meta name="twitter:description" content="These are the class notes and assignments for CSDE 502." />
  

<meta name="author" content="Phil Hurvitz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week1.html"/>
<link rel="next" href="week3.html"/>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CSDE 502</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-logistics"><i class="fa fa-check"></i>Course logistics</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#class-meetings"><i class="fa fa-check"></i>Class meetings</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#canvas"><i class="fa fa-check"></i>Canvas</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computing"><i class="fa fa-check"></i>Computing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assignments"><i class="fa fa-check"></i>Assignments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="week1.html"><a href="week1.html"><i class="fa fa-check"></i><b>1</b> Week 1</a><ul>
<li class="chapter" data-level="1.1" data-path="week1.html"><a href="week1.html#getting-started-on-terminal-server-4"><i class="fa fa-check"></i><b>1.1</b> Getting started on Terminal Server 4</a></li>
<li class="chapter" data-level="1.2" data-path="week1.html"><a href="week1.html#introduction-to-r-markdown-in-rstudio"><i class="fa fa-check"></i><b>1.2</b> Introduction to R Markdown in RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="week1.html"><a href="week1.html#create-a-project"><i class="fa fa-check"></i><b>1.2.1</b> Create a project</a></li>
<li class="chapter" data-level="1.2.2" data-path="week1.html"><a href="week1.html#create-an-r-markdown-file-from-built-in-rstudio-functionality"><i class="fa fa-check"></i><b>1.2.2</b> Create an R Markdown file from built-in RStudio functionality</a><ul>
<li class="chapter" data-level="1.2.2.1" data-path="week1.html"><a href="week1.html#render-the-rmd-file-as-html"><i class="fa fa-check"></i><b>1.2.2.1</b> Render the Rmd file as HTML</a></li>
</ul></li>
<li class="chapter" data-level="1.2.3" data-path="week1.html"><a href="week1.html#create-an-r-markdown-file-with-some-enhancements"><i class="fa fa-check"></i><b>1.2.3</b> Create an R Markdown file with some enhancements</a><ul>
<li class="chapter" data-level="1.2.3.1" data-path="week1.html"><a href="week1.html#render-and-view-the-enhanced-output"><i class="fa fa-check"></i><b>1.2.3.1</b> Render and view the enhanced output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="week1.html"><a href="week1.html#file-systems"><i class="fa fa-check"></i><b>1.3</b> File systems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week2.html"><a href="week2.html"><i class="fa fa-check"></i><b>2</b> Week 2</a><ul>
<li class="chapter" data-level="2.1" data-path="week2.html"><a href="week2.html#code-to-run-for-the-in-class-exercise"><i class="fa fa-check"></i><b>2.1</b> Code to run for the in-class exercise</a></li>
<li class="chapter" data-level="2.2" data-path="week2.html"><a href="week2.html#r-data-types"><i class="fa fa-check"></i><b>2.2</b> R data types</a><ul>
<li class="chapter" data-level="2.2.1" data-path="week2.html"><a href="week2.html#logical"><i class="fa fa-check"></i><b>2.2.1</b> Logical</a></li>
<li class="chapter" data-level="2.2.2" data-path="week2.html"><a href="week2.html#numeric"><i class="fa fa-check"></i><b>2.2.2</b> Numeric</a></li>
<li class="chapter" data-level="2.2.3" data-path="week2.html"><a href="week2.html#integer"><i class="fa fa-check"></i><b>2.2.3</b> Integer</a></li>
<li class="chapter" data-level="2.2.4" data-path="week2.html"><a href="week2.html#complex"><i class="fa fa-check"></i><b>2.2.4</b> Complex</a></li>
<li class="chapter" data-level="2.2.5" data-path="week2.html"><a href="week2.html#character"><i class="fa fa-check"></i><b>2.2.5</b> Character</a></li>
<li class="chapter" data-level="2.2.6" data-path="week2.html"><a href="week2.html#raw"><i class="fa fa-check"></i><b>2.2.6</b> Raw</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="week2.html"><a href="week2.html#r-data-structures"><i class="fa fa-check"></i><b>2.3</b> R data structures</a><ul>
<li class="chapter" data-level="2.3.1" data-path="week2.html"><a href="week2.html#vector"><i class="fa fa-check"></i><b>2.3.1</b> Vector</a></li>
<li class="chapter" data-level="2.3.2" data-path="week2.html"><a href="week2.html#matrix"><i class="fa fa-check"></i><b>2.3.2</b> Matrix</a></li>
<li class="chapter" data-level="2.3.3" data-path="week2.html"><a href="week2.html#array"><i class="fa fa-check"></i><b>2.3.3</b> Array</a></li>
<li class="chapter" data-level="2.3.4" data-path="week2.html"><a href="week2.html#list"><i class="fa fa-check"></i><b>2.3.4</b> List</a></li>
<li class="chapter" data-level="2.3.5" data-path="week2.html"><a href="week2.html#factor"><i class="fa fa-check"></i><b>2.3.5</b> Factor</a></li>
<li class="chapter" data-level="2.3.6" data-path="week2.html"><a href="week2.html#data-frame"><i class="fa fa-check"></i><b>2.3.6</b> Data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="week2.html"><a href="week2.html#tidyverse"><i class="fa fa-check"></i><b>2.4</b> tidyverse</a><ul>
<li class="chapter" data-level="2.4.1" data-path="week2.html"><a href="week2.html#magrittr"><i class="fa fa-check"></i><b>2.4.1</b> magrittr</a></li>
<li class="chapter" data-level="2.4.2" data-path="week2.html"><a href="week2.html#data-subsetting-dplyr"><i class="fa fa-check"></i><b>2.4.2</b> Data subsetting (dplyr)</a><ul>
<li class="chapter" data-level="2.4.2.0.1" data-path="week2.html"><a href="week2.html#logical-tests"><i class="fa fa-check"></i><b>2.4.2.0.1</b> Logical tests</a></li>
<li class="chapter" data-level="2.4.2.1" data-path="week2.html"><a href="week2.html#subset-rows-filter"><i class="fa fa-check"></i><b>2.4.2.1</b> Subset rows (<code>filter()</code>)</a></li>
<li class="chapter" data-level="2.4.2.2" data-path="week2.html"><a href="week2.html#subset-columns-select"><i class="fa fa-check"></i><b>2.4.2.2</b> Subset columns (<code>select()</code>)</a></li>
<li class="chapter" data-level="2.4.2.3" data-path="week2.html"><a href="week2.html#subset-rows-and-columns-filter-and-select"><i class="fa fa-check"></i><b>2.4.2.3</b> Subset rows and columns: <code>filter()</code> and <code>select()</code></a></li>
<li class="chapter" data-level="2.4.2.4" data-path="week2.html"><a href="week2.html#create-or-calculate-columns-mutate"><i class="fa fa-check"></i><b>2.4.2.4</b> Create or calculate columns: <code>mutate()</code></a></li>
<li class="chapter" data-level="2.4.2.5" data-path="week2.html"><a href="week2.html#summarizingaggregating-data"><i class="fa fa-check"></i><b>2.4.2.5</b> Summarizing/aggregating data</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week3.html"><a href="week3.html"><i class="fa fa-check"></i><b>3</b> Week 3</a><ul>
<li class="chapter" data-level="3.1" data-path="week3.html"><a href="week3.html#graphics-in-r-markdown"><i class="fa fa-check"></i><b>3.1</b> Graphics in R Markdown</a><ul>
<li class="chapter" data-level="3.1.1" data-path="week3.html"><a href="week3.html#base-r-graphics"><i class="fa fa-check"></i><b>3.1.1</b> Base R graphics</a></li>
<li class="chapter" data-level="3.1.2" data-path="week3.html"><a href="week3.html#ggplot2-graphics"><i class="fa fa-check"></i><b>3.1.2</b> <code>ggplot2</code> graphics</a></li>
<li class="chapter" data-level="3.1.3" data-path="week3.html"><a href="week3.html#embedding-graphics-files"><i class="fa fa-check"></i><b>3.1.3</b> Embedding graphics files</a><ul>
<li class="chapter" data-level="3.1.3.1" data-path="week3.html"><a href="week3.html#knitr"><i class="fa fa-check"></i><b>3.1.3.1</b> <code>knitr</code></a></li>
<li class="chapter" data-level="3.1.3.2" data-path="week3.html"><a href="week3.html#markdown-captionfilename"><i class="fa fa-check"></i><b>3.1.3.2</b> Markdown: <code>![caption](filename)</code></a></li>
<li class="chapter" data-level="3.1.3.3" data-path="week3.html"><a href="week3.html#html-img-tag"><i class="fa fa-check"></i><b>3.1.3.3</b> HTML <code>&lt;img&gt;</code> tag</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="week3.html"><a href="week3.html#tables-in-r-markdown"><i class="fa fa-check"></i><b>3.2</b> Tables in R Markdown</a><ul>
<li class="chapter" data-level="3.2.1" data-path="week3.html"><a href="week3.html#kntir-kable-and-kableextra"><i class="fa fa-check"></i><b>3.2.1</b> <code>kntir</code> (<code>kable()</code>) and <code>kableExtra</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="week3.html"><a href="week3.html#stargazer"><i class="fa fa-check"></i><b>3.2.2</b> <code>stargazer</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="week3.html"><a href="week3.html#pander"><i class="fa fa-check"></i><b>3.2.3</b> <code>pander</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="week3.html"><a href="week3.html#captions-to-support-tables-figures-and-equations"><i class="fa fa-check"></i><b>3.3</b> Captions to support tables, figures, and equations</a><ul>
<li class="chapter" data-level="3.3.1" data-path="week3.html"><a href="week3.html#figures"><i class="fa fa-check"></i><b>3.3.1</b> Figures</a><ul>
<li class="chapter" data-level="3.3.1.1" data-path="week3.html"><a href="week3.html#r-markdown-code-chunk-fig.cap"><i class="fa fa-check"></i><b>3.3.1.1</b> R Markdown code chunk <code>fig.cap</code></a></li>
<li class="chapter" data-level="3.3.1.2" data-path="week3.html"><a href="week3.html#bookdown-with-html_document2-output-type"><i class="fa fa-check"></i><b>3.3.1.2</b> <code>bookdown</code> with <code>html_document2</code> output type</a></li>
</ul></li>
<li class="chapter" data-level="3.3.2" data-path="week3.html"><a href="week3.html#tables-kable-caption"><i class="fa fa-check"></i><b>3.3.2</b> Tables: <code>kable()</code> &quot;caption&quot;</a><ul>
<li class="chapter" data-level="3.3.2.1" data-path="week3.html"><a href="week3.html#bookdown-with-html_document2-output-type-1"><i class="fa fa-check"></i><b>3.3.2.1</b> <code>bookdown</code> with <code>html_document2</code> output type</a></li>
</ul></li>
<li class="chapter" data-level="3.3.3" data-path="week3.html"><a href="week3.html#equations"><i class="fa fa-check"></i><b>3.3.3</b> Equations</a></li>
<li class="chapter" data-level="3.3.4" data-path="week3.html"><a href="week3.html#captioner-for-any-captioning-and-cross-referencing-figures-and-tables"><i class="fa fa-check"></i><b>3.3.4</b> <code>captioner</code> for any captioning and cross-referencing figures and tables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="week3.html"><a href="week3.html#r-markdown-to-microsoft-word"><i class="fa fa-check"></i><b>3.4</b> R Markdown to Microsoft Word</a></li>
<li class="chapter" data-level="3.5" data-path="week3.html"><a href="week3.html#r-markdown-output"><i class="fa fa-check"></i><b>3.5</b> R Markdown output</a><ul>
<li class="chapter" data-level="3.5.1" data-path="week3.html"><a href="week3.html#r-markdown-rendering-to-specific-formats"><i class="fa fa-check"></i><b>3.5.1</b> R Markdown rendering to specific formats</a></li>
<li class="chapter" data-level="3.5.2" data-path="week3.html"><a href="week3.html#testing-output_type"><i class="fa fa-check"></i><b>3.5.2</b> Testing <code>output_type()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="week3.html"><a href="week3.html#advantages-and-disadvantages-of-pdf"><i class="fa fa-check"></i><b>3.6</b> Advantages and disadvantages of PDF</a></li>
<li class="chapter" data-level="3.7" data-path="week3.html"><a href="week3.html#bibliography-in-r-markdown"><i class="fa fa-check"></i><b>3.7</b> Bibliography in R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week4.html"><a href="week4.html"><i class="fa fa-check"></i><b>4</b> Week 4</a><ul>
<li class="chapter" data-level="4.1" data-path="week4.html"><a href="week4.html#environments"><i class="fa fa-check"></i><b>4.1</b> Environments</a></li>
<li class="chapter" data-level="4.2" data-path="week4.html"><a href="week4.html#functions"><i class="fa fa-check"></i><b>4.2</b> Functions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="week4.html"><a href="week4.html#function-components"><i class="fa fa-check"></i><b>4.2.1</b> Function Components</a><ul>
<li class="chapter" data-level="4.2.1.1" data-path="week4.html"><a href="week4.html#name"><i class="fa fa-check"></i><b>4.2.1.1</b> Name</a></li>
<li class="chapter" data-level="4.2.1.2" data-path="week4.html"><a href="week4.html#arguments"><i class="fa fa-check"></i><b>4.2.1.2</b> Arguments</a><ul>
<li class="chapter" data-level="4.2.1.2.1" data-path="week4.html"><a href="week4.html#default-values-for-arguments"><i class="fa fa-check"></i><b>4.2.1.2.1</b> Default values for arguments</a></li>
<li class="chapter" data-level="4.2.1.2.2" data-path="week4.html"><a href="week4.html#the-...-argument"><i class="fa fa-check"></i><b>4.2.1.2.2</b> The <code>...</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.3" data-path="week4.html"><a href="week4.html#body"><i class="fa fa-check"></i><b>4.2.1.3</b> Body</a></li>
<li class="chapter" data-level="4.2.1.4" data-path="week4.html"><a href="week4.html#return-value"><i class="fa fa-check"></i><b>4.2.1.4</b> Return value</a></li>
<li class="chapter" data-level="4.2.1.5" data-path="week4.html"><a href="week4.html#function-environments"><i class="fa fa-check"></i><b>4.2.1.5</b> Function environments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="week4.html"><a href="week4.html#sampling"><i class="fa fa-check"></i><b>4.3</b> Sampling</a><ul>
<li class="chapter" data-level="4.3.1" data-path="week4.html"><a href="week4.html#sampling-with-replacement"><i class="fa fa-check"></i><b>4.3.1</b> Sampling with replacement</a></li>
<li class="chapter" data-level="4.3.2" data-path="week4.html"><a href="week4.html#sampling-without-replacement"><i class="fa fa-check"></i><b>4.3.2</b> Sampling without replacement</a></li>
<li class="chapter" data-level="4.3.3" data-path="week4.html"><a href="week4.html#bootstrapping"><i class="fa fa-check"></i><b>4.3.3</b> Bootstrapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week5.html"><a href="week5.html"><i class="fa fa-check"></i><b>5</b> Week 5</a><ul>
<li class="chapter" data-level="5.1" data-path="week5.html"><a href="week5.html#why-use-version-control"><i class="fa fa-check"></i><b>5.1</b> Why use version control?</a></li>
<li class="chapter" data-level="5.2" data-path="week5.html"><a href="week5.html#why-use-git"><i class="fa fa-check"></i><b>5.2</b> Why use Git?</a></li>
<li class="chapter" data-level="5.3" data-path="week5.html"><a href="week5.html#limitations-of-version-control-systems"><i class="fa fa-check"></i><b>5.3</b> Limitations of version control systems</a></li>
<li class="chapter" data-level="5.4" data-path="week5.html"><a href="week5.html#a-brief-git-tutorial"><i class="fa fa-check"></i><b>5.4</b> A brief Git tutorial</a><ul>
<li class="chapter" data-level="5.4.1" data-path="week5.html"><a href="week5.html#setting-up-git-in-rstudio"><i class="fa fa-check"></i><b>5.4.1</b> Setting up Git in RStudio</a></li>
<li class="chapter" data-level="5.4.2" data-path="week5.html"><a href="week5.html#creating-a-repository"><i class="fa fa-check"></i><b>5.4.2</b> Creating a repository</a></li>
<li class="chapter" data-level="5.4.3" data-path="week5.html"><a href="week5.html#tracking-changes"><i class="fa fa-check"></i><b>5.4.3</b> Tracking changes</a></li>
<li class="chapter" data-level="5.4.4" data-path="week5.html"><a href="week5.html#git-bash-shell"><i class="fa fa-check"></i><b>5.4.4</b> Git bash shell</a></li>
<li class="chapter" data-level="5.4.5" data-path="week5.html"><a href="week5.html#ignoring-specific-files"><i class="fa fa-check"></i><b>5.4.5</b> Ignoring specific files</a></li>
<li class="chapter" data-level="5.4.6" data-path="week5.html"><a href="week5.html#exploring-file-change-history"><i class="fa fa-check"></i><b>5.4.6</b> Exploring file change history</a></li>
<li class="chapter" data-level="5.4.7" data-path="week5.html"><a href="week5.html#restoring-a-previous-version"><i class="fa fa-check"></i><b>5.4.7</b> Restoring a previous version</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="week5.html"><a href="week5.html#conclusion"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a></li>
<li class="chapter" data-level="5.6" data-path="week5.html"><a href="week5.html#source-code"><i class="fa fa-check"></i><b>5.6</b> Source code</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week6.html"><a href="week6.html"><i class="fa fa-check"></i><b>6</b> Week 6</a><ul>
<li class="chapter" data-level="6.1" data-path="week6.html"><a href="week6.html#the-add-health-study-data"><i class="fa fa-check"></i><b>6.1</b> The Add Health study data</a></li>
<li class="chapter" data-level="6.2" data-path="week6.html"><a href="week6.html#documentation"><i class="fa fa-check"></i><b>6.2</b> Documentation</a></li>
<li class="chapter" data-level="6.3" data-path="week6.html"><a href="week6.html#data-sets"><i class="fa fa-check"></i><b>6.3</b> Data sets</a><ul>
<li class="chapter" data-level="6.3.1" data-path="week6.html"><a href="week6.html#ahwave1_v1.dta"><i class="fa fa-check"></i><b>6.3.1</b> <code>AHwave1_v1.dta</code></a><ul>
<li class="chapter" data-level="6.3.1.1" data-path="week6.html"><a href="week6.html#havenread_dta"><i class="fa fa-check"></i><b>6.3.1.1</b> <code>haven::read_dta()</code></a></li>
<li class="chapter" data-level="6.3.1.2" data-path="week6.html"><a href="week6.html#readstata13read.dta13"><i class="fa fa-check"></i><b>6.3.1.2</b> <code>readstata13::read.dta13()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3.2" data-path="week6.html"><a href="week6.html#data.dta"><i class="fa fa-check"></i><b>6.3.2</b> <code>21600-0001-Data.dta</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="week6.html"><a href="week6.html#searching-through-documentation"><i class="fa fa-check"></i><b>6.4</b> Searching through documentation</a><ul>
<li class="chapter" data-level="6.4.1" data-path="week6.html"><a href="week6.html#pdfgrep"><i class="fa fa-check"></i><b>6.4.1</b> <code>pdfgrep</code></a><ul>
<li class="chapter" data-level="6.4.1.1" data-path="week6.html"><a href="week6.html#a-few-use-examples"><i class="fa fa-check"></i><b>6.4.1.1</b> A few use examples</a></li>
</ul></li>
<li class="chapter" data-level="6.4.2" data-path="week6.html"><a href="week6.html#pdftoolspdf_text"><i class="fa fa-check"></i><b>6.4.2</b> <code>pdftools::pdf_text()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="week6.html"><a href="week6.html#conclusion-1"><i class="fa fa-check"></i><b>6.5</b> Conclusion</a></li>
<li class="chapter" data-level="6.6" data-path="week6.html"><a href="week6.html#source-code-1"><i class="fa fa-check"></i><b>6.6</b> Source code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week7.html"><a href="week7.html"><i class="fa fa-check"></i><b>7</b> Week 7</a><ul>
<li class="chapter" data-level="7.1" data-path="week7.html"><a href="week7.html#creating-value-labels"><i class="fa fa-check"></i><b>7.1</b> Creating value labels</a><ul>
<li class="chapter" data-level="7.1.1" data-path="week7.html"><a href="week7.html#creating-factor-variables"><i class="fa fa-check"></i><b>7.1.1</b> Creating factor variables</a></li>
<li class="chapter" data-level="7.1.2" data-path="week7.html"><a href="week7.html#creating-attributes"><i class="fa fa-check"></i><b>7.1.2</b> Creating attributes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="week7.html"><a href="week7.html#tabulation"><i class="fa fa-check"></i><b>7.2</b> Tabulation</a><ul>
<li class="chapter" data-level="7.2.1" data-path="week7.html"><a href="week7.html#raw-counts"><i class="fa fa-check"></i><b>7.2.1</b> Raw counts</a></li>
<li class="chapter" data-level="7.2.2" data-path="week7.html"><a href="week7.html#proportionspercentages"><i class="fa fa-check"></i><b>7.2.2</b> Proportions/percentages</a></li>
<li class="chapter" data-level="7.2.3" data-path="week7.html"><a href="week7.html#stratified-tabulation"><i class="fa fa-check"></i><b>7.2.3</b> Stratified tabulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="week7.html"><a href="week7.html#source-code-2"><i class="fa fa-check"></i><b>7.3</b> Source code</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week8.html"><a href="week8.html"><i class="fa fa-check"></i><b>8</b> Week 8</a><ul>
<li class="chapter" data-level="8.1" data-path="week8.html"><a href="week8.html#scale-scoring"><i class="fa fa-check"></i><b>8.1</b> Scale scoring</a><ul>
<li class="chapter" data-level="8.1.1" data-path="week8.html"><a href="week8.html#selecting-specific-columns"><i class="fa fa-check"></i><b>8.1.1</b> Selecting specific columns</a></li>
<li class="chapter" data-level="8.1.2" data-path="week8.html"><a href="week8.html#comparing-participant-answers-to-correct-answers"><i class="fa fa-check"></i><b>8.1.2</b> Comparing participant answers to correct answers</a></li>
<li class="chapter" data-level="8.1.3" data-path="week8.html"><a href="week8.html#scoring-across-columns"><i class="fa fa-check"></i><b>8.1.3</b> Scoring across columns</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="week8.html"><a href="week8.html#reordering-values"><i class="fa fa-check"></i><b>8.2</b> Reordering values</a></li>
<li class="chapter" data-level="8.3" data-path="week8.html"><a href="week8.html#source-code-3"><i class="fa fa-check"></i><b>8.3</b> Source code</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="week9.html"><a href="week9.html"><i class="fa fa-check"></i><b>9</b> Week 9</a><ul>
<li class="chapter" data-level="9.1" data-path="week9.html"><a href="week9.html#substituting-text"><i class="fa fa-check"></i><b>9.1</b> Substituting text</a><ul>
<li class="chapter" data-level="9.1.1" data-path="week9.html"><a href="week9.html#paste-paste0"><i class="fa fa-check"></i><b>9.1.1</b> <code>paste()</code>, <code>paste0()</code></a></li>
<li class="chapter" data-level="9.1.2" data-path="week9.html"><a href="week9.html#sprintf"><i class="fa fa-check"></i><b>9.1.2</b> <code>sprintf()</code></a><ul>
<li class="chapter" data-level="9.1.2.1" data-path="week9.html"><a href="week9.html#formatting-numerical-values"><i class="fa fa-check"></i><b>9.1.2.1</b> Formatting numerical values</a></li>
<li class="chapter" data-level="9.1.2.2" data-path="week9.html"><a href="week9.html#string-substitutions"><i class="fa fa-check"></i><b>9.1.2.2</b> String substitutions</a></li>
</ul></li>
<li class="chapter" data-level="9.1.3" data-path="week9.html"><a href="week9.html#str_replace-str_replace_all"><i class="fa fa-check"></i><b>9.1.3</b> <code>str_replace()</code>, <code>str_replace_all()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="week9.html"><a href="week9.html#showing-progress"><i class="fa fa-check"></i><b>9.2</b> Showing progress</a></li>
<li class="chapter" data-level="9.3" data-path="week9.html"><a href="week9.html#turning-text-into-code-evalparsetext-some-string"><i class="fa fa-check"></i><b>9.3</b> Turning text into code: <code>eval(parse(text = &quot;some string&quot;))</code></a></li>
<li class="chapter" data-level="9.4" data-path="week9.html"><a href="week9.html#sql-in-r-with-rsqlite-and-sqldf"><i class="fa fa-check"></i><b>9.4</b> SQL in R with <code>RSQLite</code> and <code>sqldf</code></a></li>
<li class="chapter" data-level="9.5" data-path="week9.html"><a href="week9.html#downloading-files-from-password-protected-web-sites"><i class="fa fa-check"></i><b>9.5</b> Downloading files from password-protected web sites</a></li>
<li class="chapter" data-level="9.6" data-path="week9.html"><a href="week9.html#dates-and-time-stamps-posixct-and-lubridate"><i class="fa fa-check"></i><b>9.6</b> Dates and time stamps: <code>POSIXct</code> and <code>lubridate</code></a></li>
<li class="chapter" data-level="9.7" data-path="week9.html"><a href="week9.html#timing-with-sys.time-and-difftime"><i class="fa fa-check"></i><b>9.7</b> Timing with <code>Sys.time()</code> and <code>difftime()</code></a></li>
<li class="chapter" data-level="9.8" data-path="week9.html"><a href="week9.html#faster-files-with-fst"><i class="fa fa-check"></i><b>9.8</b> Faster files with <code>fst()</code></a></li>
<li class="chapter" data-level="9.9" data-path="week9.html"><a href="week9.html#getting-us-census-data-with-tigris-tidycensus"><i class="fa fa-check"></i><b>9.9</b> Getting US Census data with <code>tigris</code>, <code>tidycensus</code></a></li>
<li class="chapter" data-level="9.10" data-path="week9.html"><a href="week9.html#easier-regular-expressions-with-rverbalexpressions"><i class="fa fa-check"></i><b>9.10</b> Easier regular expressions with <code>RVerbalExpressions</code></a></li>
<li class="chapter" data-level="9.11" data-path="week9.html"><a href="week9.html#quick-copy-from-excel-windows-only"><i class="fa fa-check"></i><b>9.11</b> Quick copy from Excel (Windows only)</a></li>
<li class="chapter" data-level="9.12" data-path="week9.html"><a href="week9.html#running-system-commands"><i class="fa fa-check"></i><b>9.12</b> Running system commands</a></li>
<li class="chapter" data-level="9.13" data-path="week9.html"><a href="week9.html#code-styling"><i class="fa fa-check"></i><b>9.13</b> Code styling</a></li>
<li class="chapter" data-level="9.14" data-path="week9.html"><a href="week9.html#session-information"><i class="fa fa-check"></i><b>9.14</b> Session information</a></li>
<li class="chapter" data-level="9.15" data-path="week9.html"><a href="week9.html#comment-out-rmdhtml-code"><i class="fa fa-check"></i><b>9.15</b> Comment out Rmd/HTML code</a></li>
<li class="chapter" data-level="9.16" data-path="week9.html"><a href="week9.html#source-code-4"><i class="fa fa-check"></i><b>9.16</b> Source code</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="zoom.html"><a href="zoom.html"><i class="fa fa-check"></i><b>10</b> Zoom Recordings</a><ul>
<li class="chapter" data-level="10.1" data-path="zoom.html"><a href="zoom.html#start-time-jan-8-2021-1027-am"><i class="fa fa-check"></i><b>10.1</b> Start Time: Jan 8, 2021 10:27 AM</a></li>
<li class="chapter" data-level="10.2" data-path="zoom.html"><a href="zoom.html#start-time-jan-22-2021-1021-am"><i class="fa fa-check"></i><b>10.2</b> Start Time: Jan 22, 2021 10:21 AM</a></li>
<li class="chapter" data-level="10.3" data-path="zoom.html"><a href="zoom.html#start-time-jan-29-2021-1025-am"><i class="fa fa-check"></i><b>10.3</b> Start Time: Jan 29, 2021 10:25 AM</a></li>
<li class="chapter" data-level="10.4" data-path="zoom.html"><a href="zoom.html#start-time-feb-5-2021-1028-am"><i class="fa fa-check"></i><b>10.4</b> Start Time: Feb 5, 2021 10:28 AM</a></li>
<li class="chapter" data-level="10.5" data-path="zoom.html"><a href="zoom.html#start-time-feb-12-2021-1027-am"><i class="fa fa-check"></i><b>10.5</b> Start Time: Feb 12, 2021 10:27 AM</a></li>
<li class="chapter" data-level="10.6" data-path="zoom.html"><a href="zoom.html#start-time-feb-19-2021-1021-am"><i class="fa fa-check"></i><b>10.6</b> Start Time: Feb 19, 2021 10:21 AM</a></li>
<li class="chapter" data-level="10.7" data-path="zoom.html"><a href="zoom.html#start-time-feb-26-2021-1029-am"><i class="fa fa-check"></i><b>10.7</b> Start Time : Feb 26, 2021 10:29 AM</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CSDE 502 Winter 2021</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week2" class="section level1">
<h1><span class="header-section-number">2</span> Week 2</h1>
<h2>
Topics: R data structures; tidyverse
</h2>
<p>It is assumed that students in this course have a basic working knowledge of using R, including how to create variables with the assignment operator (&quot;<code>&lt;-</code>&quot;), and how to run simple functions(e.g., <code>mean(dat$age)</code>). Often in courses that include using R for statistical analysis, some of the following foundations are not explained fully. This is not intended to be a comprehensive treatment of R data types and structures, but should provide some background for students who are either relatively new at using R or who have not had a systematic introduction.</p>
<p>The other main topic for today is <a href="https://www.tidyverse.org/">&quot;tidyverse&quot;</a>, which refers to a related set of R packages for data management, analysis, and display. See Hadley Wickham's <a href="https://tidyverse.tidyverse.org/articles/manifesto.html">tidy tools manifesto</a> for the logic behind the suite of tools. For a brief description of the specific R packages, see <a href="https://www.tidyverse.org/packages/">Tidyverse packages</a>. This is not intended to be a comprehensive introduction, but should provide sufficient background for data handling to support most of the technical aspects of the rest of the course.</p>
<div id="code-to-run-for-the-in-class-exercise" class="section level2">
<h2><span class="header-section-number">2.1</span> Code to run for the in-class exercise</h2>
<p>For the exercise in class, download <a href="r_code/week02.R">week02.R</a>, which we will use to run the code listed in this R Markdown result.</p>
</div>
<div id="r-data-types" class="section level2">
<h2><span class="header-section-number">2.2</span> R data types</h2>
<p>There are six fundamental data types in R:</p>
<ol style="list-style-type: decimal">
<li>logical</li>
<li>numeric</li>
<li>integer</li>
<li>complex</li>
<li>character</li>
<li>raw</li>
</ol>
<p>The most atomic object in R will exist having one of those data types, described below. An atomic object of the data type can have a value, <code>NA</code> which represents an observation with no data (e.g., a missing measurement), or <code>NULL</code> which isn't really a value at all, but can still have the data type class.</p>
<p>You will encounter other data types, such as <code>Date</code> or <code>POSIXct</code> if you are working with dates or time stamps. These other data types are extensions of the fundamental data types.</p>
<p>To determine what data type an object is, use <code>is(obj)</code>, <code>str(obj)</code>, or <code>class(obj)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">is</span>(<span class="st">&quot;a&quot;</span>))</code></pre></div>
<pre><code>## [1] &quot;character&quot;           &quot;vector&quot;              &quot;data.frameRowLabels&quot; &quot;SuperClassMethod&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">str</span>(<span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##  logi TRUE
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">class</span>(<span class="fl">123.45</span>))</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">class</span>(<span class="kw">as.integer</span>(<span class="dv">1000</span>)))</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="dv">999999999999999999999</span>)

<span class="kw">print</span>(<span class="kw">class</span>(n))</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div id="logical" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Logical</h3>
<p>Use <code>logical</code> values for characteristics that are either <code>TRUE</code> or <code>FALSE</code>. Note that if <code>logical</code> elements can also have an <code>NA</code> value if the observation is missing. In the following examples,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># evaluate as logical, test whether 1 is greater than two</span>
a &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create two numerical values, one being NA, representing ages</span>
age_john &lt;-<span class="st"> </span><span class="dv">39</span>
age_jane &lt;-<span class="st"> </span><span class="ot">NA</span>

<span class="co"># logical NA from Jane&#39;s undefined age</span>
(jo &lt;-<span class="st"> </span>age_john <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(ja &lt;-<span class="st"> </span>age_jane <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>)</code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Logical values are often expressed in binary format as 0 = <code>FALSE</code> and <code>=</code>TRUE`. in R these values are interconvertible. Other software (e.g., Excel, MS Access) may convert logical values to numbers that you do not expect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(t &lt;-<span class="st"> </span><span class="kw">as.logical</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(f &lt;-<span class="st"> </span><span class="kw">as.logical</span>(<span class="dv">0</span>))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="numeric" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Numeric</h3>
<p><code>Numeric</code> values are numbers with range about 2e-308 to 2e+308, depending on the computer you are using. You can see the possible range by entering <code>.Machine</code> at the R console. These can also include decimals. For more information, see <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">Double-precision floating-point format</a></p>
</div>
<div id="integer" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Integer</h3>
<p><code>Integer</code> values are numerical, but can only take on whole, rather than fractional values, and have a truncated range compared to <code>numeric</code>. For example, see below, if we try to create an integer that is out of range. The object we created is an integer, but because it is out of range, is value is set to <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="dv">999999999999999999999</span>)</code></pre></div>
<pre><code>## Warning: NAs introduced by coercion to integer range</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">class</span>(i))</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
</div>
<div id="complex" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Complex</h3>
<p>The <code>complex</code> type is used in mathematics and you are unlikely to use it in applied social science research unless you get into some heavy statistics. See <a href="https://en.wikipedia.org/wiki/Complex_number">Complex number</a> for a full treatment.</p>
</div>
<div id="character" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Character</h3>
<p><code>Character</code> data include the full set of keys on your keyboard that print out a character, typically [A-Z], [a-z], [0-9], punctuation, etc. The full set of ASCII characters is supported, e.g. the <code>accent aigu</code> in Café:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">class</span>(<span class="st">&quot;Café&quot;</span>))</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Also numbers can function as characters. Be careful in converting between numerical and character versions. For example, see these ZIP codes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this is a character</span>
my_zip &lt;-<span class="st"> &quot;98115&quot;</span>

<span class="co"># it is not numeric.</span>
my_zip <span class="op">+</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>## Error in my_zip + 2: non-numeric argument to binary operator</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># we can convert it to numeric, although it would be silly to do with ZIP codes, which are nominal values</span>
<span class="kw">as.numeric</span>(my_zip) <span class="op">+</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>## [1] 98117</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Boston has ZIP codes starting with zeros</span>
boston_zip &lt;-<span class="st"> &quot;02134&quot;</span>
<span class="kw">as.numeric</span>(boston_zip)</code></pre></div>
<pre><code>## [1] 2134</code></pre>
</div>
<div id="raw" class="section level3">
<h3><span class="header-section-number">2.2.6</span> Raw</h3>
<p><code>Raw</code> values are used to store raw bytes in hexadecimal format. You are unlikely to use it in applied social science research. For example, the hexadecimal value for the character <code>z</code> is <code>7a</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">charToRaw</span>(<span class="st">&quot;z&quot;</span>))</code></pre></div>
<pre><code>## [1] 7a</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="kw">charToRaw</span>(<span class="st">&quot;z&quot;</span>))</code></pre></div>
<pre><code>## [1] &quot;raw&quot;</code></pre>
</div>
</div>
<div id="r-data-structures" class="section level2">
<h2><span class="header-section-number">2.3</span> R data structures</h2>
<div class="figure">
<img src="images/week02/data_structures.png" />

</div>
<p>There are 5 basic data structures in R, as shown in the graphic:</p>
<ol style="list-style-type: decimal">
<li>vector</li>
<li>matrix</li>
<li>array</li>
<li>list</li>
<li>data frame</li>
</ol>
<p>In addition, the <code>factor</code> data type is very important</p>
<div id="vector" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Vector</h3>
<p>A vector is an ordered set of elements of one or more elements of the same data type and are created using the <code>c()</code> constructor function. For example, a single value is a vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a vector of length 1</span>
a &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="kw">is</span>(a)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot; &quot;vector&quot;</code></pre>
<p>If you try creating a vector with mixed data types, you may get unexpected results; mixing character elements with other type elements will result in character representations, e.g.,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;a&quot;</span>, <span class="ot">TRUE</span>, <span class="kw">charToRaw</span>(<span class="st">&quot;z&quot;</span>))</code></pre></div>
<pre><code>## [1] &quot;1&quot;    &quot;a&quot;    &quot;TRUE&quot; &quot;7a&quot;</code></pre>
<p>Results will depend on the data type you are mixing, for example because logical values can be expressed numerically, the <code>TRUE</code> and <code>FALSE</code> values are converted to <code>1</code> and <code>0</code>, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>## [1] 1 2 3 1 0</code></pre>
<p>But if a character is added, all elements are converted to characters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="st">&quot;awesome!&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;1&quot;        &quot;2&quot;        &quot;3&quot;        &quot;TRUE&quot;     &quot;FALSE&quot;    &quot;awesome!&quot;</code></pre>
<p>Order is important, i.e.,</p>
<p><code>1, 2, 3</code> is not the same as <code>1, 3, 2</code></p>
<p>R will maintain the order of elements in vectors unless a process is initiated that changes the order of those elements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a vector </span>
(v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 1 3 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">sort</span>(v))</code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>You can get some information about vectors, such as length and data type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a random normal </span>
<span class="kw">set.seed</span>(<span class="dv">5</span>)
normvec1000 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>)

<span class="kw">length</span>(normvec1000)</code></pre></div>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(normvec1000)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(normvec1000 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<p>Elements of vectors are specified with their index number (1 .. n):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)
v[<span class="dv">4</span>]</code></pre></div>
<pre><code>## [1] 6</code></pre>
</div>
<div id="matrix" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Matrix</h3>
<p>A matrix is like a vector, in that it an contain only one data type, but it is two-dimensional, having rows and columns. A simple example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make a vector 1 to 100</span>
(v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27
##  [28]  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81
##  [82]  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load to a matrix</span>
(m1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(v, <span class="dt">ncol =</span> <span class="dv">10</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
##  [1,]    1    2    3    4    5    6    7    8    9    10
##  [2,]   11   12   13   14   15   16   17   18   19    20
##  [3,]   21   22   23   24   25   26   27   28   29    30
##  [4,]   31   32   33   34   35   36   37   38   39    40
##  [5,]   41   42   43   44   45   46   47   48   49    50
##  [6,]   51   52   53   54   55   56   57   58   59    60
##  [7,]   61   62   63   64   65   66   67   68   69    70
##  [8,]   71   72   73   74   75   76   77   78   79    80
##  [9,]   81   82   83   84   85   86   87   88   89    90
## [10,]   91   92   93   94   95   96   97   98   99   100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># different r, c ordering</span>
(m2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(v, <span class="dt">ncol =</span> <span class="dv">10</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
##  [1,]    1   11   21   31   41   51   61   71   81    91
##  [2,]    2   12   22   32   42   52   62   72   82    92
##  [3,]    3   13   23   33   43   53   63   73   83    93
##  [4,]    4   14   24   34   44   54   64   74   84    94
##  [5,]    5   15   25   35   45   55   65   75   85    95
##  [6,]    6   16   26   36   46   56   66   76   86    96
##  [7,]    7   17   27   37   47   57   67   77   87    97
##  [8,]    8   18   28   38   48   58   68   78   88    98
##  [9,]    9   19   29   39   49   59   69   79   89    99
## [10,]   10   20   30   40   50   60   70   80   90   100</code></pre>
<p>If you try to force a vector into a matrix whose row <span class="math inline">\(\times\)</span> col length does not match the length of the vector, the elements will be recycled, which may not be what you want. At least R will give you a warning.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(m3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(letters, <span class="dt">ncol =</span> <span class="dv">10</span>, <span class="dt">nrow =</span> <span class="dv">10</span>))</code></pre></div>
<pre><code>## Warning in matrix(letters, ncol = 10, nrow = 10): data length [26] is not a sub-multiple or multiple of the number
## of rows [10]</code></pre>
<pre><code>##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
##  [1,] &quot;a&quot;  &quot;k&quot;  &quot;u&quot;  &quot;e&quot;  &quot;o&quot;  &quot;y&quot;  &quot;i&quot;  &quot;s&quot;  &quot;c&quot;  &quot;m&quot;  
##  [2,] &quot;b&quot;  &quot;l&quot;  &quot;v&quot;  &quot;f&quot;  &quot;p&quot;  &quot;z&quot;  &quot;j&quot;  &quot;t&quot;  &quot;d&quot;  &quot;n&quot;  
##  [3,] &quot;c&quot;  &quot;m&quot;  &quot;w&quot;  &quot;g&quot;  &quot;q&quot;  &quot;a&quot;  &quot;k&quot;  &quot;u&quot;  &quot;e&quot;  &quot;o&quot;  
##  [4,] &quot;d&quot;  &quot;n&quot;  &quot;x&quot;  &quot;h&quot;  &quot;r&quot;  &quot;b&quot;  &quot;l&quot;  &quot;v&quot;  &quot;f&quot;  &quot;p&quot;  
##  [5,] &quot;e&quot;  &quot;o&quot;  &quot;y&quot;  &quot;i&quot;  &quot;s&quot;  &quot;c&quot;  &quot;m&quot;  &quot;w&quot;  &quot;g&quot;  &quot;q&quot;  
##  [6,] &quot;f&quot;  &quot;p&quot;  &quot;z&quot;  &quot;j&quot;  &quot;t&quot;  &quot;d&quot;  &quot;n&quot;  &quot;x&quot;  &quot;h&quot;  &quot;r&quot;  
##  [7,] &quot;g&quot;  &quot;q&quot;  &quot;a&quot;  &quot;k&quot;  &quot;u&quot;  &quot;e&quot;  &quot;o&quot;  &quot;y&quot;  &quot;i&quot;  &quot;s&quot;  
##  [8,] &quot;h&quot;  &quot;r&quot;  &quot;b&quot;  &quot;l&quot;  &quot;v&quot;  &quot;f&quot;  &quot;p&quot;  &quot;z&quot;  &quot;j&quot;  &quot;t&quot;  
##  [9,] &quot;i&quot;  &quot;s&quot;  &quot;c&quot;  &quot;m&quot;  &quot;w&quot;  &quot;g&quot;  &quot;q&quot;  &quot;a&quot;  &quot;k&quot;  &quot;u&quot;  
## [10,] &quot;j&quot;  &quot;t&quot;  &quot;d&quot;  &quot;n&quot;  &quot;x&quot;  &quot;h&quot;  &quot;r&quot;  &quot;b&quot;  &quot;l&quot;  &quot;v&quot;</code></pre>
</div>
<div id="array" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Array</h3>
<p>An array is similar to matrix, but it can have more than one dimension. These can be useful for analyzing time series data or other multidimensional data. We will not be using array data in this course, but a simple example of creating and viewing the contents of an array:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a vector 1 to 27</span>
v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">27</span>

<span class="co"># create an array, 3 x 3 x 3</span>
(a &lt;-<span class="st"> </span><span class="kw">array</span>(v, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)))</code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## 
## , , 2
## 
##      [,1] [,2] [,3]
## [1,]   10   13   16
## [2,]   11   14   17
## [3,]   12   15   18
## 
## , , 3
## 
##      [,1] [,2] [,3]
## [1,]   19   22   25
## [2,]   20   23   26
## [3,]   21   24   27</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># array index is r, c, m (row, column, matrix), e.g., row 1 column 2 matrix 3:</span>
(a[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</code></pre></div>
<pre><code>## [1] 22</code></pre>
</div>
<div id="list" class="section level3">
<h3><span class="header-section-number">2.3.4</span> List</h3>
<p>R lists are ordered collections of objects that do not need to be of the same data type. Those objects can be single-value vectors, multiple-value vectors, matrices, data frames, other lists, etc. Because of this, lists are a very flexible data type. But because they can have as little or as much structure as you want, can become difficult to manage and analyze.</p>
<p>Here is an example of a list comprised of single value vectors of different data type. Compare this with the attempt to make a vector comprised of elements of different data type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">1</span>, <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## [[1]]
## [1] &quot;a&quot;
## 
## [[2]]
## [1] 1
## 
## [[3]]
## [1] TRUE</code></pre>
<p>Let's modify that list a bit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;a&quot;</span>, 
           <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, 
           <span class="kw">as.logical</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>))))</code></pre></div>
<pre><code>## [[1]]
## [1] &quot;a&quot;
## 
## [[2]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
## 
## [[3]]
## [1] FALSE  TRUE  TRUE FALSE</code></pre>
<p>The top-level indexing for a list is denoted using two sets of square brackets. For example, the first element of our list can be accessed by <code>l[[1]]</code>. For example, the mean of element 2 is obtained by <code>mean(l[[2]])</code>: <code>10.5</code>.</p>
<p>To perform operations on all elements of a list, use <code>lapply()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show the data types</span>
(<span class="kw">lapply</span>(<span class="dt">X =</span> l, <span class="dt">FUN =</span> class))</code></pre></div>
<pre><code>## [[1]]
## [1] &quot;character&quot;
## 
## [[2]]
## [1] &quot;integer&quot;
## 
## [[3]]
## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mean, maybe?</span>
(<span class="kw">lapply</span>(<span class="dt">X =</span> l, <span class="dt">FUN =</span> <span class="cf">function</span>(x) {<span class="kw">mean</span>(x)}))</code></pre></div>
<pre><code>## Warning in mean.default(x): argument is not numeric or logical: returning NA</code></pre>
<pre><code>## [[1]]
## [1] NA
## 
## [[2]]
## [1] 10.5
## 
## [[3]]
## [1] 0.5</code></pre>
</div>
<div id="factor" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Factor</h3>
<p>Factors are similar to vectors, in that they are one-dimensional ordered sets. However, factors also use informational labels. For example, you may have a variable with household income as a text value:</p>
<ul>
<li>&quot;&lt;$10,000&quot;</li>
<li>&quot;$10,000-$549,999&quot;</li>
<li>&quot;$50,000-$99,999&quot;</li>
<li>&quot;$100,000-$200,000&quot;</li>
<li>&quot;&gt;$200,000&quot;</li>
</ul>
<p>As a vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(income &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&lt;$10,000&quot;</span>
, <span class="st">&quot;$10,000-$49,999&quot;</span>
, <span class="st">&quot;$50,000-$99,999&quot;</span>
, <span class="st">&quot;$100,000-$200,000&quot;</span>
, <span class="st">&quot;&gt;$200,000&quot;</span>))</code></pre></div>
<pre><code>## [1] &quot;&lt;$10,000&quot;          &quot;$10,000-$49,999&quot;   &quot;$50,000-$99,999&quot;   &quot;$100,000-$200,000&quot; &quot;&gt;$200,000&quot;</code></pre>
<p>Because these are characters, they do not sort in proper numeric order:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(income)</code></pre></div>
<pre><code>## [1] &quot;$10,000-$49,999&quot;   &quot;$100,000-$200,000&quot; &quot;$50,000-$99,999&quot;   &quot;&lt;$10,000&quot;          &quot;&gt;$200,000&quot;</code></pre>
<p>If these are treated as a factor, the levels can be set for proper ordering:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a factor from income and set the levels</span>
(income_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> income, <span class="dt">levels =</span> income))</code></pre></div>
<pre><code>## [1] &lt;$10,000          $10,000-$49,999   $50,000-$99,999   $100,000-$200,000 &gt;$200,000        
## Levels: &lt;$10,000 $10,000-$49,999 $50,000-$99,999 $100,000-$200,000 &gt;$200,000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sort again</span>
(<span class="kw">sort</span>(income_factor))</code></pre></div>
<pre><code>## [1] &lt;$10,000          $10,000-$49,999   $50,000-$99,999   $100,000-$200,000 &gt;$200,000        
## Levels: &lt;$10,000 $10,000-$49,999 $50,000-$99,999 $100,000-$200,000 &gt;$200,000</code></pre>
<p>As a factor, the data can also be used in statistical models and the magnitude of the variable will also be correctly ordered.</p>
</div>
<div id="data-frame" class="section level3">
<h3><span class="header-section-number">2.3.6</span> Data frame</h3>
<p>Other than vectors, data frames are probably the most used data type in R. You can think of data frames as matrices that allow columns with different data type. For example, you might have a data set that represents subject IDs as characters, sex or gender as text, height, weight, and age as numerical values, income as a factor, and smoking status as logical. Because a matrix requires only one data type, it would not be possible to store all of these as a matrix. An example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># income levels </span>
inc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&lt;$10,000&quot;</span>
, <span class="st">&quot;$10,000-$49,999&quot;</span>
, <span class="st">&quot;$50,000-$99,999&quot;</span>
, <span class="st">&quot;$100,000-$200,000&quot;</span>
, <span class="st">&quot;&gt;$200,000&quot;</span>)

BMI &lt;-<span class="st">  </span><span class="kw">data.frame</span>(
   <span class="dt">sid =</span> <span class="kw">c</span>(<span class="st">&quot;A1001&quot;</span>, <span class="st">&quot;A1002&quot;</span>, <span class="st">&quot;B1001&quot;</span>),
   <span class="dt">gender =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>), 
   <span class="dt">height_cm =</span> <span class="kw">c</span>(<span class="dv">152</span>, <span class="fl">171.5</span>, <span class="dv">165</span>), 
   <span class="dt">weight_kg =</span> <span class="kw">c</span>(<span class="dv">81</span>, <span class="dv">93</span>, <span class="dv">78</span>),
   <span class="dt">age_y =</span> <span class="kw">c</span>(<span class="dv">42</span>, <span class="dv">38</span>, <span class="dv">26</span>),
   <span class="dt">income =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;$50,000-$99,999&quot;</span>, <span class="st">&quot;$100,000-$200,000&quot;</span>, <span class="st">&quot;&lt;$10,000&quot;</span>), <span class="dt">levels =</span> inc)
)
<span class="kw">print</span>(BMI)</code></pre></div>
<pre><code>##     sid gender height_cm weight_kg age_y            income
## 1 A1001   Male     152.0        81    42   $50,000-$99,999
## 2 A1002   Male     171.5        93    38 $100,000-$200,000
## 3 B1001 Female     165.0        78    26          &lt;$10,000</code></pre>
</div>
</div>
<div id="tidyverse" class="section level2">
<h2><span class="header-section-number">2.4</span> tidyverse</h2>
<p>This section will introduce some of the main workhorse functions in tidy data handling.</p>
<p>Installing tidyverse is straightforward but it may take some time to download and install all of the packages. Use</p>
<pre><code>install.packages(&quot;tidyverse&quot;)</code></pre>
<p>For today's lesson we will be using one of the Add Health data sets, <a href="data/AHwave1_v1.dta">AHwave1_v1.dta</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read the dta file</span>
dat &lt;-<span class="st"> </span>readstata13<span class="op">::</span><span class="kw">read.dta13</span>(<span class="st">&quot;http://staff.washington.edu/phurvitz/csde502_winter_2021/data/AHwave1_v1.dta&quot;</span>)</code></pre></div>
<p>The data set includes variable labels, which make handling the data easier. Here we print the column names and their labels. Wrapping this in a <code>DT::data_table</code> presents a nice interface for showing only a few variables at a time and that allows sorting and searching.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">colname =</span> <span class="kw">names</span>(dat), <span class="dt">label =</span> <span class="kw">attributes</span>(dat)<span class="op">$</span>var.labels)
DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">data =</span> x, <span class="dt">caption =</span> <span class="st">&quot;Column names and labels in AHwave1_v1.dta.&quot;</span>)</code></pre></div>
<div id="htmlwidget-fe43102361867a1adb51" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fe43102361867a1adb51">{"x":{"filter":"none","caption":"<caption>Column names and labels in AHwave1_v1.dta.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103"],["aid","imonth","iday","iyear","bio_sex","h1gi1m","h1gi1y","h1gi4","h1gi5a","h1gi5b","h1gi5c","h1gi5d","h1gi5e","h1gi5f","h1gi6a","h1gi6b","h1gi6c","h1gi6d","h1gi6e","h1gi7a","h1gi7b","h1gi7c","h1gi7d","h1gi7e","h1gi7f","h1gi7g","h1gi8","h1gi9","h1gh1","h1fs1","h1fs2","h1fs3","h1fs4","h1fs5","h1fs6","h1fs7","h1fs8","h1fs9","h1fs10","h1fs11","h1fs12","h1fs13","h1fs14","h1fs15","h1fs16","h1fs17","h1fs18","h1fs19","h1hr2a","h1hr3a","h1hr4a","h1hr5a","h1hr6a","h1hr7a","h1hr8a","h1hr2b","h1hr3b","h1hr4b","h1hr5b","h1hr6b","h1hr7b","h1hr8b","h1hr2c","h1hr3c","h1hr4c","h1hr5c","h1hr6c","h1hr7c","h1hr8c","h1hr2d","h1hr3d","h1hr4d","h1hr5d","h1hr6d","h1hr7d","h1hr8d","h1hr2e","h1hr3e","h1hr4e","h1hr5e","h1hr6e","h1hr7e","h1hr8e","h1kq1a","h1kq1b","h1kq2a","h1kq2b","h1kq3a","h1kq3b","h1kq4a","h1kq4b","h1kq5a","h1kq5b","h1kq6a","h1kq6b","h1kq7a","h1kq7b","h1kq8a","h1kq8b","h1kq9a","h1kq9b","h1kq10a","h1kq10b"],["RESPONDENT IDENTIFIER","MONTH OF INTERVIEW-W1","DAY OF INTERVIEW-W1","YEAR OF INTERVIEW-W1","BIOLOGICAL SEX-W1","S1Q1 BIRTH MONTH-W1","S1Q1 BIRTH YEAR-W1","S1Q4 ARE YOU OF HISPANIC ORIGIN-W1","S1Q5A HISPANIC-MEXICAN-W1","S1Q5B HISPANIC-CHICANO-W1","S1Q5C HISPANIC-CUBAN-W1","S1Q5D HISPANIC-PUERTO RICAN-W1","S1Q5E HISPANIC-CENTRAL/SO AMER-W1","S1Q5F HISPANIC-OTHER-W1","S1Q6A RACE-WHITE-W1","S1Q6B RACE-AFRICAN AMERICAN-W1","S1Q6C RACE-AMERICAN INDIAN-W1","S1Q6D RACE-ASIAN-W1","S1Q6E RACE-OTHER-W1","S1Q7A ASIAN-CHINESE-W1","S1Q7B ASIAN-FILIPINO-W1","S1Q7C ASIAN-JAPANESE-W1","S1Q7D ASIAN-ASIAN INDIAN-W1","S1Q7E ASIAN-KOREAN-W1","S1Q7F ASIAN-VIETNAMESE-W1","S1Q7G ASIAN-OTHER-W1","S1Q8 RACE-SINGLE CATEGORY-W1","S1Q9 RACE-INTERVIEWER OBSERVATION-W1","S3Q1 GENERAL HEALTH-W1","S10Q1 BOTHERED BY THINGS-W1","S10Q2 POOR APPETITE-W1","S10Q3 HAD THE BLUES-W1","S10Q4 JUST AS GOOD AS OTHER PEOPLE-W1","S10Q5 TROUBLE KEEPING MIND FOCUSED-W1","S10Q6 FELT DEPRESSED-W1","S10Q7 TOO TIRED TO DO THINGS-W1","S10Q8 HOPEFUL ABOUT THE FUTURE-W1","S10Q9 LIFE HAD BEEN A FAILURE-W1","S10Q10 FEARFUL-W1","S10Q11 HAPPY-W1","S10Q12 TALKED LESS THAN USUAL-W1","S10Q13 FELT LONELY-W1","S10Q14 PEOPLE UNFRIENDLY TO YOU-W1","S10Q15 ENJOYED LIFE-W1","S10Q16 FELT SAD-W1","S10Q17 FELT PEOPLE DISLIKE YOU-W1","S10Q18 HARD TO START DOING THINGS-W1","S10Q19 LIFE NOT WORTH LIVING-W1","S11Q2A HH MEMBER 1-GENDER-W1","S11Q3A HH MEMBER 1-RELATION TO YOU-W1","S11Q4A HH MEMBER 1-OFFSPRING-W1","S11Q5A HH MEMBER 1-SIBLING-W1","S11Q6A HH MEMBER 1-PARENT-W1","S11Q7A HH MEMBER 1-AGE-W1","S11Q8A HH MEMBER 1-APPROXIMATE AGE-W1","S11Q2B HH MEMBER 2-GENDER-W1","S11Q3B HH MEMBER 2-RELATION TO YOU-W1","S11Q4B HH MEMBER 2-OFFSPRING-W1","S11Q5B HH MEMBER 2-SIBLING-W1","S11Q6B HH MEMBER 2-PARENT-W1","S11Q7B HH MEMBER 2-AGE-W1","S11Q8B HH MEMBER 2-APPROXIMATE AGE-W1","S11Q2C HH MEMBER 3-GENDER-W1","S11Q3C HH MEMBER 3-RELATION TO YOU-W1","S11Q4C HH MEMBER 3-OFFSPRING-W1","S11Q5C HH MEMBER 3-SIBLING-W1","S11Q6C HH MEMBER 3-PARENT-W1","S11Q7C HH MEMBER 3-AGE-W1","S11Q8C HH MEMBER 3-APPROXIMATE AGE-W1","S11Q2D HH MEMBER 4-GENDER-W1","S11Q3D HH MEMBER 4-RELATION TO YOU-W1","S11Q4D HH MEMBER 4-OFFSPRING-W1","S11Q5D HH MEMBER 4-SIBLING-W1","S11Q6D HH MEMBER 4-PARENT-W1","S11Q7D HH MEMBER 4-AGE-W1","S11Q8D HH MEMBER 4-APPROXIMATE AGE-W1","S11Q2E HH MEMBER 5-GENDER-W1","S11Q3E HH MEMBER 5-RELATION TO YOU-W1","S11Q4E HH MEMBER 5-OFFSPRING-W1","S11Q5E HH MEMBER 5-SIBLING-W1","S11Q6E HH MEMBER 5-PARENT-W1","S11Q7E HH MEMBER 5-AGE-W1","S11Q8E HH MEMBER 5-APPROXIMATE AGE-W1","S19Q1A SPERM DIES W/I 6 HOURS-W1","S19Q1B CONFIDENT 1A IS CORRECT-W1","S19Q2A CONDOM-MAN SHOULD W/D IMMED-W1","S19Q2B CONFIDENT 2A IS CORRECT-W1","S19Q3A WOMAN OVULATES 14 DAYS AFT PD-W1","S19Q3B CONFIDENT 3A IS CORRECT-W1","S19Q4A LAMBSKIN IS BETTER THAN LATEX-W1","S19Q4B CONFIDENT 4A IS CORRECT-W1","S19Q5A CONDOM SHOULD FIT TIGHTLY-W1","S19Q5B CONFIDENT 5A IS CORRECT-W1","S19Q6A VASELINE CANBE USED W/ CONDOMS-W1","S19Q6B CONFIDENT 6A IS CORRECT-W1","S19Q7A MOST FERTILE BEFORE PERIOD-W1","S19Q7B CONFIDENT 7A IS CORRECT-W1","S19Q8A PREGN POSSIBLE W/ OUTSIDE EJAC-W1","S19Q8B CONFIDENT 8A IS CORRECT-W1","S19Q9A ONLY PENIS TIP NEEDS COVERAGE-W1","S19Q9B CONFIDENT 9A IS CORRECT-W1","S19Q10A MOST FERTILE DURING PERIOD-W1","S19Q10B CONFIDENT 10A IS CORRECT-W1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>colname<\/th>\n      <th>label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<div id="magrittr" class="section level3">
<h3><span class="header-section-number">2.4.1</span> magrittr</h3>
<div class="figure">
<img src="images/week02/unepipe.jpeg" />

</div>
<p>The R package <a href="https://cran.r-project.org/web/packages/magrittr/index.html"><code>magrittr</code></a> allows the use of &quot;pipes&quot;. In UNIX, pipes were used to take the output of one program and to feed as input to another program. For example, the UNIX command <code>cat</code> prints the contents of a text file. This would print the contents of the file <code>00README.txt</code>:</p>
<p><code>cat 00README.txt</code></p>
<p>but with large files, the entire contents would scroll by too fast to read. Using a &quot;pipe&quot;, denoted with the vertical bar character <code>|</code> allowed using the <code>more</code> command to print one screen at a time by tapping the <code>Enter</code> key for each screen full of text:</p>
<p><code>cat 00README.txt | more</code></p>
<p>As shown in these two screen captures:</p>
<div class="figure">
<img src="images/week02/cat_more.png" />

</div>
<div class="figure">
<img src="images/week02/cat_more2.png" />

</div>
<p>The two main pipe operators we will use in <code>magrittr</code> are <code>%&gt;%</code> and '%&lt;&gt;%'.</p>
<p><code>%&gt;%</code> is the pipe operator, which functions as a UNIX pipe, that is, to take something on the left hand side of the operator and feed it to the right hand side.</p>
<p><code>%&lt;&gt;%</code> is the assignment pipe operator, which takes something on the left hand side of the operator, feeds it to the right hand side, and replaces the object on the left-hand side.</p>
<p>For a simple example of the pipe, to list only the first 6 lines of a data frame in base R, we use <code>head()</code>, e.g.,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iris)</code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>using a tidy version of this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>In the R base version, we first read <code>head</code>, so we know we will be printing the first 6 elements of something, but we don't know what that &quot;something&quot; is. We have to read ahead to know we are reading the first 6 records of <code>iris</code>. In the tidy version, we start by knowing we are doing something to the data set, after which we know we are printing the first 6 records.</p>
<p>In base R functions, the process is evaluated from the inside out. For example, to get the mean sepal length of the <em>setosa</em> species in iris, we would do this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &#39;setosa&#39;</span>, <span class="st">&quot;Sepal.Length&quot;</span>])</code></pre></div>
<pre><code>## [1] 5.006</code></pre>
<p>From the inside out, we read that we are making a subset of <code>iris</code> where Species = &quot;setosa&quot;, we are selecting the column &quot;Sepal.Length&quot;, and taking the mean. However, it requires reading from the inside out. For a large set of nested functions, we would have <code>y &lt;- f(g(h((i(x)))))</code>, which would require first creating the innermost function (<code>i()</code>) and then working outward.</p>
<p>In a tidy approach this would be more like y &lt;- x %&gt;% i() %&gt;% h() %&gt;% g() %&gt;% f()<code>because the first function applied to the data set</code>x<code>is</code>i()`. Revisiting the mean sepal length of <em>setosa</em> irises, example, under a tidy approach we would do this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &#39;setosa&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(Sepal.Length))</code></pre></div>
<pre><code>##   mean(Sepal.Length)
## 1              5.006</code></pre>
<p>Which, read from left to right, translates to &quot;using the iris data frame, make a subset of records where species is <em>setosa</em>, and summarize those records to get the mean value of sepal length.&quot; The tidy version is intended to be easier to write, read, and understand. The command uses the <code>filter()</code> function, which will be described below.</p>
</div>
<div id="data-subsetting-dplyr" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Data subsetting (dplyr)</h3>
<p><code>dplyr</code> is the tidyverse R package used most frequently for data manipulation. Selection of records (i.e., subsetting) is done using logical tests to determine what is in the selected set. First we will look at logical tests and then we will cover subsetting rows and columns from data frames.</p>
<div id="logical-tests" class="section level5">
<h5><span class="header-section-number">2.4.2.0.1</span> Logical tests</h5>
<p>If elements meet a logical test, they will end up in the selected set. If data frame records have values in variables that meet logical criteria, the records will be selected.</p>
<p>Some logical tests are shown below.</p>
<div id="equals" class="section level6">
<h6><span class="header-section-number">2.4.2.0.1.1</span> <code>==</code>: equals</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># numeric tests</span>
(<span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># character test (actually a factor)</span>
(dat<span class="op">$</span>imonth <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_c</span>(<span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>))</code></pre></div>
<pre><code>## [1] &quot;(6) June, (5) May, (6) June, (7) July, (7) July, (6) June&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">((dat<span class="op">$</span>imonth <span class="op">==</span><span class="st"> &quot;(6) June&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>())</code></pre></div>
<pre><code>## [1]  TRUE FALSE  TRUE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># character test for multiple patterns</span>
(dat<span class="op">$</span>imonth <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;(6) June&quot;</span>, <span class="st">&quot;(7) July&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>())</code></pre></div>
<pre><code>## [1]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE</code></pre>
</div>
<div id="numeric-comparisons" class="section level6">
<h6><span class="header-section-number">2.4.2.0.1.2</span> <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>: numeric comparisons</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">&lt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">10</span><span class="op">:</span><span class="dv">10</span></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [19]  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">10</span><span class="op">:</span><span class="dv">10</span></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
## [19] FALSE FALSE FALSE</code></pre>
</div>
<div id="not-equals" class="section level6">
<h6><span class="header-section-number">2.4.2.0.1.3</span> <code>!=</code>: not equals</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">!=</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># those of the first 6 days that are not 14</span>
(dat<span class="op">$</span>iday <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>())</code></pre></div>
<pre><code>## [1] 23  5 27 14 14 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">((dat<span class="op">$</span>iday <span class="op">!=</span><span class="st"> </span><span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>())</code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<div id="invert-or-not" class="section level6">
<h6><span class="header-section-number">2.4.2.0.1.4</span> <code>!</code>: invert, or &quot;not&quot;</h6>
<p>Sometimes it is more convenient to negate a single condition rather than enumerating all possible matching conditions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>imonth <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">20</span>)</code></pre></div>
<pre><code>##  [1] (6) June      (5) May       (6) June      (7) July      (7) July      (6) June      (5) May      
##  [8] (6) June      (6) June      (8) August    (9) September (5) May       (6) June      (7) July     
## [15] (5) May       (5) May       (7) July      (5) May       (8) August    (7) July     
## 10 Levels: (1) January (4) April (5) May (6) June (7) July (8) August (9) September ... (12) December</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">((<span class="op">!</span>dat<span class="op">$</span>imonth <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;(6) June&quot;</span>, <span class="st">&quot;(7) July&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">20</span>))</code></pre></div>
<pre><code>##  [1] FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE
## [19]  TRUE FALSE</code></pre>
</div>
</div>
<div id="subset-rows-filter" class="section level4">
<h4><span class="header-section-number">2.4.2.1</span> Subset rows (<code>filter()</code>)</h4>
<p>The <code>filter()</code> function creates a subset of records based on a logical test. Logical tests can be combined as &quot;and&quot; statements using the <code>&amp;</code> operator and &quot;or&quot; statements using the <code>|</code> operator. Here we will perform a few filters on a subset of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first 20 records, fist 10 columns</span>
dat_sub &lt;-<span class="st"> </span>dat[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="kw">kable</span>(dat_sub, <span class="dt">format =</span> <span class="st">&quot;html&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width =</span> F, <span class="dt">position =</span> <span class="st">&quot;left&quot;</span>)</code></pre></div>
<pre><code>## Warning in if (!full_width) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="">
<thead>
<tr>
<th style="text-align:left;">
aid
</th>
<th style="text-align:left;">
imonth
</th>
<th style="text-align:right;">
iday
</th>
<th style="text-align:left;">
iyear
</th>
<th style="text-align:left;">
bio_sex
</th>
<th style="text-align:left;">
h1gi1m
</th>
<th style="text-align:left;">
h1gi1y
</th>
<th style="text-align:left;">
h1gi4
</th>
<th style="text-align:left;">
h1gi5a
</th>
<th style="text-align:left;">
h1gi5b
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
57100270
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
<ol start="77" style="list-style-type: decimal">
<li>1977
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57101310
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="11" style="list-style-type: decimal">
<li>November
</td>
<td style="text-align:left;">
<ol start="76" style="list-style-type: decimal">
<li>1976
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57103171
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
<ol start="79" style="list-style-type: decimal">
<li>1979
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57103869
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>January
</td>
<td style="text-align:left;">
<ol start="77" style="list-style-type: decimal">
<li>1977
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57104553
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:left;">
<ol start="76" style="list-style-type: decimal">
<li>1976
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57104649
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="12" style="list-style-type: decimal">
<li>December
</td>
<td style="text-align:left;">
<ol start="81" style="list-style-type: decimal">
<li>1981
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57104676
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
<ol start="83" style="list-style-type: decimal">
<li>1983
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57109625
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="3" style="list-style-type: decimal">
<li>March
</td>
<td style="text-align:left;">
<ol start="81" style="list-style-type: decimal">
<li>1981
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57110897
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
<ol start="81" style="list-style-type: decimal">
<li>1981
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57111071
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:left;">
<ol start="81" style="list-style-type: decimal">
<li>1981
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57111786
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
<ol start="80" style="list-style-type: decimal">
<li>1980
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57113943
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>January
</td>
<td style="text-align:left;">
<ol start="79" style="list-style-type: decimal">
<li>1979
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57116359
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
<ol start="80" style="list-style-type: decimal">
<li>1980
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57117542
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
<ol start="79" style="list-style-type: decimal">
<li>1979
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57117997
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
<ol start="82" style="list-style-type: decimal">
<li>1982
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57118381
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
<ol start="82" style="list-style-type: decimal">
<li>1982
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57118943
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
<ol start="79" style="list-style-type: decimal">
<li>1979
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57120005
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
<ol start="82" style="list-style-type: decimal">
<li>1982
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
<tr>
<td style="text-align:left;">
57120046
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Male
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
<ol start="76" style="list-style-type: decimal">
<li>1976
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Yes
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>Marked
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>Not marked
</td>
</tr>
<tr>
<td style="text-align:left;">
57120371
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="95" style="list-style-type: decimal">
<li>1995
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>Female
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:left;">
<ol start="76" style="list-style-type: decimal">
<li>1976
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal">
<li>No
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>Legitimate skip (not Hispanic)
</td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>Records from one month:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># from May</span>
(dat_sub <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(imonth <span class="op">==</span><span class="st"> &quot;(5) May&quot;</span>))</code></pre></div>
<pre><code>##        aid  imonth iday     iyear    bio_sex        h1gi1m    h1gi1y  h1gi4                             h1gi5a
## 1 57101310 (5) May    5 (95) 1995 (2) Female (11) November (76) 1976 (0) No (7) Legitimate skip (not Hispanic)
## 2 57104676 (5) May   31 (95) 1995   (1) Male  (10) October (83) 1983 (0) No (7) Legitimate skip (not Hispanic)
## 3 57113943 (5) May   20 (95) 1995   (1) Male   (1) January (79) 1979 (0) No (7) Legitimate skip (not Hispanic)
## 4 57117997 (5) May   20 (95) 1995 (2) Female  (10) October (82) 1982 (0) No (7) Legitimate skip (not Hispanic)
## 5 57118381 (5) May    6 (95) 1995 (2) Female  (10) October (82) 1982 (0) No (7) Legitimate skip (not Hispanic)
## 6 57120005 (5) May   25 (95) 1995   (1) Male (9) September (82) 1982 (0) No (7) Legitimate skip (not Hispanic)
##                               h1gi5b
## 1 (7) Legitimate skip (not Hispanic)
## 2 (7) Legitimate skip (not Hispanic)
## 3 (7) Legitimate skip (not Hispanic)
## 4 (7) Legitimate skip (not Hispanic)
## 5 (7) Legitimate skip (not Hispanic)
## 6 (7) Legitimate skip (not Hispanic)</code></pre>
<p>Records from one month from females:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(dat_sub <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(imonth <span class="op">==</span><span class="st"> &quot;(5) May&quot;</span> <span class="op">&amp;</span><span class="st"> </span>bio_sex <span class="op">==</span><span class="st"> &quot;(2) Female&quot;</span>))</code></pre></div>
<pre><code>##        aid  imonth iday     iyear    bio_sex        h1gi1m    h1gi1y  h1gi4                             h1gi5a
## 1 57101310 (5) May    5 (95) 1995 (2) Female (11) November (76) 1976 (0) No (7) Legitimate skip (not Hispanic)
## 2 57117997 (5) May   20 (95) 1995 (2) Female  (10) October (82) 1982 (0) No (7) Legitimate skip (not Hispanic)
## 3 57118381 (5) May    6 (95) 1995 (2) Female  (10) October (82) 1982 (0) No (7) Legitimate skip (not Hispanic)
##                               h1gi5b
## 1 (7) Legitimate skip (not Hispanic)
## 2 (7) Legitimate skip (not Hispanic)
## 3 (7) Legitimate skip (not Hispanic)</code></pre>
<p>Records from one month and from females or where the day of month was before the 15th, which will probably include some males:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(dat_sub <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(imonth <span class="op">==</span><span class="st"> &quot;(5) May&quot;</span> <span class="op">&amp;</span><span class="st"> </span>(bio_sex <span class="op">==</span><span class="st"> &quot;(2) Female&quot;</span>) <span class="op">|</span><span class="st"> </span>iday <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>))</code></pre></div>
<pre><code>##         aid        imonth iday     iyear    bio_sex        h1gi1m    h1gi1y  h1gi4
## 1  57101310       (5) May    5 (95) 1995 (2) Female (11) November (76) 1976 (0) No
## 2  57103869      (7) July   14 (95) 1995   (1) Male   (1) January (77) 1977 (0) No
## 3  57104553      (7) July   14 (95) 1995 (2) Female      (6) June (76) 1976 (0) No
## 4  57104649      (6) June   12 (95) 1995   (1) Male (12) December (81) 1981 (0) No
## 5  57109625      (6) June    7 (95) 1995   (1) Male     (3) March (81) 1981 (0) No
## 6  57111071    (8) August    3 (95) 1995   (1) Male      (6) June (81) 1981 (0) No
## 7  57111786 (9) September    7 (95) 1995   (1) Male (9) September (80) 1980 (0) No
## 8  57117542      (7) July   11 (95) 1995   (1) Male (9) September (79) 1979 (0) No
## 9  57117997       (5) May   20 (95) 1995 (2) Female  (10) October (82) 1982 (0) No
## 10 57118381       (5) May    6 (95) 1995 (2) Female  (10) October (82) 1982 (0) No
##                                h1gi5a                             h1gi5b
## 1  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 2  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 3  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 4  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 5  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 6  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 7  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 8  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 9  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 10 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)</code></pre>
<p>Although these examples are silly and trivial, they show how <code>filter()</code> is used to create a selected set of data</p>
</div>
<div id="subset-columns-select" class="section level4">
<h4><span class="header-section-number">2.4.2.2</span> Subset columns (<code>select()</code>)</h4>
<p>A subset of columns can be extracted from data frames using the <code>select()</code> function, most simply using named list of columns to keep.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select 3 columns</span>
(dat_sub_sel &lt;-<span class="st"> </span>dat_sub <span class="op">%&gt;%</span><span class="st">   </span>
<span class="st">    </span><span class="kw">select</span>(<span class="st">&quot;aid&quot;</span>, <span class="st">&quot;imonth&quot;</span>, <span class="st">&quot;iday&quot;</span>))</code></pre></div>
<pre><code>##         aid        imonth iday
## 1  57100270      (6) June   23
## 2  57101310       (5) May    5
## 3  57103171      (6) June   27
## 4  57103869      (7) July   14
## 5  57104553      (7) July   14
## 6  57104649      (6) June   12
## 7  57104676       (5) May   31
## 8  57109625      (6) June    7
## 9  57110897      (6) June   27
## 10 57111071    (8) August    3
## 11 57111786 (9) September    7
## 12 57113943       (5) May   20
## 13 57116359      (6) June   24
## 14 57117542      (7) July   11
## 15 57117997       (5) May   20
## 16 57118381       (5) May    6
## 17 57118943      (7) July   19
## 18 57120005       (5) May   25
## 19 57120046    (8) August   20
## 20 57120371      (7) July   20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select all but two named columns</span>
(dat_sub_sel &lt;-<span class="st"> </span>dat_sub <span class="op">%&gt;%</span><span class="st">   </span>
<span class="st">    </span><span class="kw">select</span>(<span class="op">-</span><span class="st">&quot;imonth&quot;</span>, <span class="op">-</span><span class="st">&quot;iday&quot;</span>))</code></pre></div>
<pre><code>##         aid     iyear    bio_sex        h1gi1m    h1gi1y   h1gi4                             h1gi5a
## 1  57100270 (95) 1995 (2) Female  (10) October (77) 1977  (0) No (7) Legitimate skip (not Hispanic)
## 2  57101310 (95) 1995 (2) Female (11) November (76) 1976  (0) No (7) Legitimate skip (not Hispanic)
## 3  57103171 (95) 1995   (1) Male  (10) October (79) 1979  (0) No (7) Legitimate skip (not Hispanic)
## 4  57103869 (95) 1995   (1) Male   (1) January (77) 1977  (0) No (7) Legitimate skip (not Hispanic)
## 5  57104553 (95) 1995 (2) Female      (6) June (76) 1976  (0) No (7) Legitimate skip (not Hispanic)
## 6  57104649 (95) 1995   (1) Male (12) December (81) 1981  (0) No (7) Legitimate skip (not Hispanic)
## 7  57104676 (95) 1995   (1) Male  (10) October (83) 1983  (0) No (7) Legitimate skip (not Hispanic)
## 8  57109625 (95) 1995   (1) Male     (3) March (81) 1981  (0) No (7) Legitimate skip (not Hispanic)
## 9  57110897 (95) 1995   (1) Male (9) September (81) 1981  (0) No (7) Legitimate skip (not Hispanic)
## 10 57111071 (95) 1995   (1) Male      (6) June (81) 1981  (0) No (7) Legitimate skip (not Hispanic)
## 11 57111786 (95) 1995   (1) Male (9) September (80) 1980  (0) No (7) Legitimate skip (not Hispanic)
## 12 57113943 (95) 1995   (1) Male   (1) January (79) 1979  (0) No (7) Legitimate skip (not Hispanic)
## 13 57116359 (95) 1995   (1) Male     (4) April (80) 1980  (0) No (7) Legitimate skip (not Hispanic)
## 14 57117542 (95) 1995   (1) Male (9) September (79) 1979  (0) No (7) Legitimate skip (not Hispanic)
## 15 57117997 (95) 1995 (2) Female  (10) October (82) 1982  (0) No (7) Legitimate skip (not Hispanic)
## 16 57118381 (95) 1995 (2) Female  (10) October (82) 1982  (0) No (7) Legitimate skip (not Hispanic)
## 17 57118943 (95) 1995 (2) Female     (4) April (79) 1979  (0) No (7) Legitimate skip (not Hispanic)
## 18 57120005 (95) 1995   (1) Male (9) September (82) 1982  (0) No (7) Legitimate skip (not Hispanic)
## 19 57120046 (95) 1995   (1) Male  (10) October (76) 1976 (1) Yes                         (1) Marked
## 20 57120371 (95) 1995 (2) Female    (8) August (76) 1976  (0) No (7) Legitimate skip (not Hispanic)
##                                h1gi5b
## 1  (7) Legitimate skip (not Hispanic)
## 2  (7) Legitimate skip (not Hispanic)
## 3  (7) Legitimate skip (not Hispanic)
## 4  (7) Legitimate skip (not Hispanic)
## 5  (7) Legitimate skip (not Hispanic)
## 6  (7) Legitimate skip (not Hispanic)
## 7  (7) Legitimate skip (not Hispanic)
## 8  (7) Legitimate skip (not Hispanic)
## 9  (7) Legitimate skip (not Hispanic)
## 10 (7) Legitimate skip (not Hispanic)
## 11 (7) Legitimate skip (not Hispanic)
## 12 (7) Legitimate skip (not Hispanic)
## 13 (7) Legitimate skip (not Hispanic)
## 14 (7) Legitimate skip (not Hispanic)
## 15 (7) Legitimate skip (not Hispanic)
## 16 (7) Legitimate skip (not Hispanic)
## 17 (7) Legitimate skip (not Hispanic)
## 18 (7) Legitimate skip (not Hispanic)
## 19                     (0) Not marked
## 20 (7) Legitimate skip (not Hispanic)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select columns by position and whose name matches a pattern, in this case the regular expression &quot;^i&quot; meaning &quot;starts with lowercase i&quot;</span>
(dat_sub_sel &lt;-<span class="st"> </span>dat_sub <span class="op">%&gt;%</span><span class="st">   </span>
<span class="st">    </span><span class="kw">select</span>(<span class="dv">1</span>, <span class="kw">matches</span>(<span class="st">&quot;^i&quot;</span>)))</code></pre></div>
<pre><code>##         aid        imonth iday     iyear
## 1  57100270      (6) June   23 (95) 1995
## 2  57101310       (5) May    5 (95) 1995
## 3  57103171      (6) June   27 (95) 1995
## 4  57103869      (7) July   14 (95) 1995
## 5  57104553      (7) July   14 (95) 1995
## 6  57104649      (6) June   12 (95) 1995
## 7  57104676       (5) May   31 (95) 1995
## 8  57109625      (6) June    7 (95) 1995
## 9  57110897      (6) June   27 (95) 1995
## 10 57111071    (8) August    3 (95) 1995
## 11 57111786 (9) September    7 (95) 1995
## 12 57113943       (5) May   20 (95) 1995
## 13 57116359      (6) June   24 (95) 1995
## 14 57117542      (7) July   11 (95) 1995
## 15 57117997       (5) May   20 (95) 1995
## 16 57118381       (5) May    6 (95) 1995
## 17 57118943      (7) July   19 (95) 1995
## 18 57120005       (5) May   25 (95) 1995
## 19 57120046    (8) August   20 (95) 1995
## 20 57120371      (7) July   20 (95) 1995</code></pre>
<p><code>select()</code> can also be used to rename columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#select one column, rename two columns</span>
(dat_sub_sel <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">select</span>(aid, <span class="dt">Month =</span> imonth, <span class="dt">Day =</span> iday))</code></pre></div>
<pre><code>##         aid         Month Day
## 1  57100270      (6) June  23
## 2  57101310       (5) May   5
## 3  57103171      (6) June  27
## 4  57103869      (7) July  14
## 5  57104553      (7) July  14
## 6  57104649      (6) June  12
## 7  57104676       (5) May  31
## 8  57109625      (6) June   7
## 9  57110897      (6) June  27
## 10 57111071    (8) August   3
## 11 57111786 (9) September   7
## 12 57113943       (5) May  20
## 13 57116359      (6) June  24
## 14 57117542      (7) July  11
## 15 57117997       (5) May  20
## 16 57118381       (5) May   6
## 17 57118943      (7) July  19
## 18 57120005       (5) May  25
## 19 57120046    (8) August  20
## 20 57120371      (7) July  20</code></pre>
<p>Or column renaming can be done with <code>rename()</code>, which maintains all input data and only changes the named columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(dat_sub_sel <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">rename</span>(<span class="dt">Month =</span> imonth, <span class="dt">Day =</span> iday))</code></pre></div>
<pre><code>##         aid         Month Day     iyear
## 1  57100270      (6) June  23 (95) 1995
## 2  57101310       (5) May   5 (95) 1995
## 3  57103171      (6) June  27 (95) 1995
## 4  57103869      (7) July  14 (95) 1995
## 5  57104553      (7) July  14 (95) 1995
## 6  57104649      (6) June  12 (95) 1995
## 7  57104676       (5) May  31 (95) 1995
## 8  57109625      (6) June   7 (95) 1995
## 9  57110897      (6) June  27 (95) 1995
## 10 57111071    (8) August   3 (95) 1995
## 11 57111786 (9) September   7 (95) 1995
## 12 57113943       (5) May  20 (95) 1995
## 13 57116359      (6) June  24 (95) 1995
## 14 57117542      (7) July  11 (95) 1995
## 15 57117997       (5) May  20 (95) 1995
## 16 57118381       (5) May   6 (95) 1995
## 17 57118943      (7) July  19 (95) 1995
## 18 57120005       (5) May  25 (95) 1995
## 19 57120046    (8) August  20 (95) 1995
## 20 57120371      (7) July  20 (95) 1995</code></pre>
</div>
<div id="subset-rows-and-columns-filter-and-select" class="section level4">
<h4><span class="header-section-number">2.4.2.3</span> Subset rows and columns: <code>filter()</code> and <code>select()</code></h4>
<p>We can combine <code>filter()</code> and <code>select()</code> with a pipe to create a new data frame with a subset of rows and columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># records with day of mongh &gt; 15 and the first 3 named columns</span>
(x &lt;-<span class="st"> </span>dat_sub <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(iday <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(aid, imonth, iday)
   )</code></pre></div>
<pre><code>##         aid     imonth iday
## 1  57100270   (6) June   23
## 2  57103171   (6) June   27
## 3  57104676    (5) May   31
## 4  57110897   (6) June   27
## 5  57113943    (5) May   20
## 6  57116359   (6) June   24
## 7  57117997    (5) May   20
## 8  57118943   (7) July   19
## 9  57120005    (5) May   25
## 10 57120046 (8) August   20
## 11 57120371   (7) July   20</code></pre>
</div>
<div id="create-or-calculate-columns-mutate" class="section level4">
<h4><span class="header-section-number">2.4.2.4</span> Create or calculate columns: <code>mutate()</code></h4>
<p><code>mutate()</code> will create new named columns or re-calculate existing columns. Here we will make a column that stratifies birth month, with the cut at June.</p>
<p>Although the birth month column (<code>h1gi1m</code>) is a factor, it is unordered, so we need to make it ordered before using the factor label in a numeric comparison. Fortunately, the factor labels were handled in correct order:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># is this ordered?</span>
<span class="kw">is.ordered</span>(dat<span class="op">$</span>h1gi1m)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># what are the levels?</span>
(<span class="kw">levels</span>(dat<span class="op">$</span>h1gi1m))</code></pre></div>
<pre><code>##  [1] &quot;(1) January&quot;   &quot;(2) February&quot;  &quot;(3) March&quot;     &quot;(4) April&quot;     &quot;(5) May&quot;       &quot;(6) June&quot;     
##  [7] &quot;(7) July&quot;      &quot;(8) August&quot;    &quot;(9) September&quot; &quot;(10) October&quot;  &quot;(11) November&quot; &quot;(12) December&quot;
## [13] &quot;(96) Refused&quot;</code></pre>
<p>Assign order, create a new column, and print nicely:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make birth month ordered</span>
dat<span class="op">$</span>h1gi1m &lt;-<span class="st"> </span><span class="kw">factor</span>(dat<span class="op">$</span>h1gi1m, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)

<span class="co"># now is it ordered?</span>
<span class="kw">is.ordered</span>(dat<span class="op">$</span>h1gi1m)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perform the mutate() using the string representation of the factor for comparison</span>
dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(iday <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(aid, imonth, iday, <span class="dt">birth_month =</span> h1gi1m) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">birth_1st_half =</span> (birth_month <span class="op">&lt;</span><span class="st"> &quot;(7) July&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">head</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width =</span> F, <span class="dt">position =</span> <span class="st">&quot;left&quot;</span>)</code></pre></div>
<pre><code>## Warning in if (!full_width) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="">
<thead>
<tr>
<th style="text-align:left;">
aid
</th>
<th style="text-align:left;">
imonth
</th>
<th style="text-align:right;">
iday
</th>
<th style="text-align:left;">
birth_month
</th>
<th style="text-align:left;">
birth_1st_half
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
57100270
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57103171
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57104676
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57110897
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57113943
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>January
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57116359
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57117997
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57118943
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57120005
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57120046
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57120371
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57121476
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57123494
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57129567
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57130633
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57131909
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
57133772
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57134457
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57136630
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
57139880
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>A silly example but showing that <code>mutate()</code> can change values of existing columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(X &lt;-<span class="st"> </span>dat_sub <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">iday =</span> <span class="op">-</span><span class="dv">1000</span> <span class="op">+</span><span class="st"> </span>iday))</code></pre></div>
<pre><code>##         aid        imonth iday     iyear    bio_sex        h1gi1m    h1gi1y   h1gi4
## 1  57100270      (6) June -977 (95) 1995 (2) Female  (10) October (77) 1977  (0) No
## 2  57101310       (5) May -995 (95) 1995 (2) Female (11) November (76) 1976  (0) No
## 3  57103171      (6) June -973 (95) 1995   (1) Male  (10) October (79) 1979  (0) No
## 4  57103869      (7) July -986 (95) 1995   (1) Male   (1) January (77) 1977  (0) No
## 5  57104553      (7) July -986 (95) 1995 (2) Female      (6) June (76) 1976  (0) No
## 6  57104649      (6) June -988 (95) 1995   (1) Male (12) December (81) 1981  (0) No
## 7  57104676       (5) May -969 (95) 1995   (1) Male  (10) October (83) 1983  (0) No
## 8  57109625      (6) June -993 (95) 1995   (1) Male     (3) March (81) 1981  (0) No
## 9  57110897      (6) June -973 (95) 1995   (1) Male (9) September (81) 1981  (0) No
## 10 57111071    (8) August -997 (95) 1995   (1) Male      (6) June (81) 1981  (0) No
## 11 57111786 (9) September -993 (95) 1995   (1) Male (9) September (80) 1980  (0) No
## 12 57113943       (5) May -980 (95) 1995   (1) Male   (1) January (79) 1979  (0) No
## 13 57116359      (6) June -976 (95) 1995   (1) Male     (4) April (80) 1980  (0) No
## 14 57117542      (7) July -989 (95) 1995   (1) Male (9) September (79) 1979  (0) No
## 15 57117997       (5) May -980 (95) 1995 (2) Female  (10) October (82) 1982  (0) No
## 16 57118381       (5) May -994 (95) 1995 (2) Female  (10) October (82) 1982  (0) No
## 17 57118943      (7) July -981 (95) 1995 (2) Female     (4) April (79) 1979  (0) No
## 18 57120005       (5) May -975 (95) 1995   (1) Male (9) September (82) 1982  (0) No
## 19 57120046    (8) August -980 (95) 1995   (1) Male  (10) October (76) 1976 (1) Yes
## 20 57120371      (7) July -980 (95) 1995 (2) Female    (8) August (76) 1976  (0) No
##                                h1gi5a                             h1gi5b
## 1  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 2  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 3  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 4  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 5  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 6  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 7  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 8  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 9  (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 10 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 11 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 12 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 13 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 14 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 15 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 16 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 17 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 18 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)
## 19                         (1) Marked                     (0) Not marked
## 20 (7) Legitimate skip (not Hispanic) (7) Legitimate skip (not Hispanic)</code></pre>
<p>... so do be careful!</p>
<p>Other functions can be used with mutate include (but are by no means limited to!)</p>
<ul>
<li><code>if_else()</code>: create a column by assigning values based on logical criteria</li>
<li><code>case_when()</code>: similar to <code>if_else()</code> but for multiple input values</li>
<li><code>recode()</code>: change particular values</li>
</ul>
<p>When we recoded the birth month, the output was a <code>logical</code> data type. If we wanted to create a <code>character</code> or <code>factor</code>, we could use <code>if_else()</code>. Here we are creating a new data frame based on several operations on <code>dat</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_<span class="dv">1</span> &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(iday <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">head</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(aid, imonth, iday, <span class="dt">birth_month =</span> h1gi1m) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">birth_year_half =</span> <span class="kw">ifelse</span>(<span class="dt">test =</span> birth_month <span class="op">&lt;</span><span class="st"> &quot;(7) July&quot;</span>, <span class="dt">yes =</span> <span class="st">&quot;first&quot;</span>, <span class="dt">no =</span> <span class="st">&quot;last&quot;</span>))

<span class="co"># make that a factor</span>
dat_<span class="dv">1</span><span class="op">$</span>birth_year_half &lt;-<span class="st"> </span><span class="kw">factor</span>(dat_<span class="dv">1</span><span class="op">$</span>birth_year_half, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;first&quot;</span>, <span class="st">&quot;last&quot;</span>))
    
<span class="co"># print</span>
<span class="kw">kable</span>(dat_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width =</span> F, <span class="dt">position =</span> <span class="st">&quot;left&quot;</span>)</code></pre></div>
<pre><code>## Warning in if (!full_width) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="">
<thead>
<tr>
<th style="text-align:left;">
aid
</th>
<th style="text-align:left;">
imonth
</th>
<th style="text-align:right;">
iday
</th>
<th style="text-align:left;">
birth_month
</th>
<th style="text-align:left;">
birth_year_half
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
57100270
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57103171
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57104676
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57110897
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57113943
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>January
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57116359
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57117997
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57118943
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57120005
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57120046
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57120371
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57121476
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57123494
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57129567
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57130633
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57131909
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:left;">
last
</td>
</tr>
<tr>
<td style="text-align:left;">
57133772
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57134457
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57136630
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:left;">
first
</td>
</tr>
<tr>
<td style="text-align:left;">
57139880
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>If one of your variables contains multiple values and you want to create classes, use <code>case_when()</code>. Here is a verbose example stratifying months into quarters. Also we are using the <code>magrittr</code> assignment pipe to update the input based on the statement, i.e., <code>dat_1</code> will change based on the commands we use. <strong>Be careful using the assignment pipe because it will change your data frame.</strong></p>
<p><code>case_when()</code> will recode in order or the way the command is written, so for months and quarters, it is not necessary to specify both ends of the quarter. Also any cases that are not explicitly handled can be addressed with the <code>TRUE ~ ...</code> argument; in this case, any records that had birth months that were not before September get assigned to quarter 4.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_<span class="dv">1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">quarter =</span> <span class="kw">case_when</span>(
        birth_month <span class="op">&lt;</span><span class="st"> &quot;(3) March&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
        birth_month <span class="op">&lt;</span><span class="st"> &quot;(6) June&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,
        birth_month <span class="op">&lt;</span><span class="st"> &quot;(9) September&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,
        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>))

<span class="co"># print</span>
<span class="kw">kable</span>(dat_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">full_width =</span> F, <span class="dt">position =</span> <span class="st">&quot;left&quot;</span>)</code></pre></div>
<pre><code>## Warning in if (!full_width) {: the condition has length &gt; 1 and only the first element will be used</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="">
<thead>
<tr>
<th style="text-align:left;">
aid
</th>
<th style="text-align:left;">
imonth
</th>
<th style="text-align:right;">
iday
</th>
<th style="text-align:left;">
birth_month
</th>
<th style="text-align:left;">
birth_year_half
</th>
<th style="text-align:right;">
quarter
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
57100270
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57103171
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57104676
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57110897
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57113943
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>January
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
57116359
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
57117997
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57118943
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
57120005
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:left;">
<ol start="9" style="list-style-type: decimal">
<li>September
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57120046
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57120371
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
57121476
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57123494
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
57129567
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
57130633
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal">
<li>August
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
57131909
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
57133772
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="2" style="list-style-type: decimal">
<li>February
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
57134457
</td>
<td style="text-align:left;">
<ol start="7" style="list-style-type: decimal">
<li>July
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
<ol start="4" style="list-style-type: decimal">
<li>April
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
57136630
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
<ol start="5" style="list-style-type: decimal">
<li>May
</td>
<td style="text-align:left;">
first
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
57139880
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal">
<li>June
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
<ol start="10" style="list-style-type: decimal">
<li>October
</td>
<td style="text-align:left;">
last
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p><code>recode()</code> is used to change the <code>birth_year_half</code> column:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(dat_<span class="dv">1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">birth_year_half_split =</span> <span class="kw">recode</span>(birth_year_half,
                   <span class="st">&quot;first&quot;</span> =<span class="st"> &quot;early&quot;</span>,
                   <span class="st">&quot;last&quot;</span> =<span class="st"> &quot;late&quot;</span>)))</code></pre></div>
<pre><code>##         aid     imonth iday   birth_month birth_year_half quarter birth_year_half_split
## 1  57100270   (6) June   23  (10) October            last       4                  late
## 2  57103171   (6) June   27  (10) October            last       4                  late
## 3  57104676    (5) May   31  (10) October            last       4                  late
## 4  57110897   (6) June   27 (9) September            last       4                  late
## 5  57113943    (5) May   20   (1) January           first       1                 early
## 6  57116359   (6) June   24     (4) April           first       2                 early
## 7  57117997    (5) May   20  (10) October            last       4                  late
## 8  57118943   (7) July   19     (4) April           first       2                 early
## 9  57120005    (5) May   25 (9) September            last       4                  late
## 10 57120046 (8) August   20  (10) October            last       4                  late
## 11 57120371   (7) July   20    (8) August            last       3                  late
## 12 57121476    (5) May   20  (10) October            last       4                  late
## 13 57123494   (7) July   21  (2) February           first       1                 early
## 14 57129567   (7) July   26  (2) February           first       1                 early
## 15 57130633 (8) August   26  (10) October            last       4                  late
## 16 57131909  (4) April   27      (7) July            last       3                  late
## 17 57133772   (7) July   19  (2) February           first       1                 early
## 18 57134457   (7) July   18     (4) April           first       2                 early
## 19 57136630    (5) May   16       (5) May           first       2                 early
## 20 57139880   (6) June   19  (10) October            last       4                  late</code></pre>
</div>
<div id="summarizingaggregating-data" class="section level4">
<h4><span class="header-section-number">2.4.2.5</span> Summarizing/aggregating data</h4>
<p>We will spend more time later in the course on data summaries, but an introduction with <code>dplyr</code> is worthwhile introducing at this stage. The two main functions are <code>summarise()</code> and <code>group_by()</code>.</p>
<p>A simple summary will tabulate the count of respondents and the mean age. The filter <code>! str_detect(h1gi1y, &quot;Refused&quot;)</code> drops records from respondents who refused to give their birth year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="st"> </span><span class="kw">str_detect</span>(h1gi1y, <span class="st">&quot;Refused&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">yeari =</span> <span class="kw">str_replace_all</span>(iyear, <span class="st">&quot;.* &quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>(),
           <span class="dt">yearb =</span> <span class="kw">str_replace_all</span>(h1gi1y, <span class="st">&quot;.* &quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">mean_age =</span> <span class="kw">mean</span>(yeari <span class="op">-</span><span class="st"> </span>yearb))</code></pre></div>
<pre><code>##      n mean_age
## 1 6501 16.03676</code></pre>
<p>Here we will summarize age by sex using the <code>group_by()</code> function, and also piping to <code>prop_table()</code> to get the percentage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="st"> </span><span class="kw">str_detect</span>(h1gi1y, <span class="st">&quot;Refused&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">yeari =</span> <span class="kw">str_replace_all</span>(iyear, <span class="st">&quot;.* &quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>(),
           <span class="dt">yearb =</span> <span class="kw">str_replace_all</span>(h1gi1y, <span class="st">&quot;.* &quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(bio_sex) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean_age =</span> <span class="kw">mean</span>(yeari <span class="op">-</span><span class="st"> </span>yearb),
              <span class="dt">sd_age =</span> <span class="kw">sd</span>(yeari <span class="op">-</span><span class="st"> </span>yearb),
              <span class="dt">n =</span> <span class="kw">n</span>(),
              <span class="dt">.groups =</span> <span class="st">&quot;drop_last&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">pct =</span> <span class="kw">prop.table</span>(n) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   bio_sex    mean_age sd_age     n   pct
##   &lt;fct&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
## 1 (1) Male       16.1   1.77  3147  48.4
## 2 (2) Female     16.0   1.77  3354  51.6</code></pre>
<h4>
Source code for this document
</h4>
<p><a href="01-week02.Rmd">02-week02.Rmd</a></p>
<pre><code># Week 2 {#week2}

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(magrittr)
library(knitr)
library(kableExtra)
library(readstata13)
```

&lt;h2&gt;Topics: R data structures; tidyverse&lt;/h2&gt;
It is assumed that students in this course have a basic working knowledge of using R, including how to create variables with the assignment operator (&quot;`&lt;-`&quot;), and how to run simple functions(e.g., `mean(dat$age)`). Often in courses that include using R for statistical analysis, some of the following foundations are not explained fully. This is not intended to be a comprehensive treatment of R data types and structures, but should provide some background for students who are either relatively new at using R or who have not had a systematic introduction.

The other main topic for today is [&quot;tidyverse&quot;](https://www.tidyverse.org/), which refers to a related set of R packages for data management, analysis, and display. See Hadley Wickham&#39;s [tidy tools manifesto](https://tidyverse.tidyverse.org/articles/manifesto.html) for the logic behind the suite of tools. For a brief description of the specific R packages, see [Tidyverse packages](https://www.tidyverse.org/packages/). This is not intended to be a comprehensive introduction, but should provide sufficient background for data handling to support most of the technical aspects of the rest of the course.

## Code to run for the in-class exercise

```{r, echo=FALSE}
# generate the R code to run in class
# O &lt;- knitr::purl(input = &quot;02-week02.Rmd&quot;, output = &quot;r_code/week02.R&quot;, quiet = TRUE, documentation = 1)
```

For the exercise in class, download [week02.R](r_code/week02.R), which we will use to run the code listed in this R Markdown result.


## R data types
There are six fundamental data types in R:

1. logical
1. numeric
1. integer
1. complex
1. character
1. raw

The most atomic object in R will exist having one of those data types, described below. An atomic object of the data type can have a value, `NA` which represents an observation with no data (e.g., a missing measurement), or `NULL` which isn&#39;t really a value at all, but can still have the data type class.

You will encounter other data types, such as `Date` or `POSIXct` if you are working with dates or time stamps. These other data types are extensions of the fundamental data types.

To determine what data type an object is, use `is(obj)`, `str(obj)`, or `class(obj)`. 

```{r}
print(is(&quot;a&quot;))

print(str(TRUE))

print(class(123.45))

print(class(as.integer(1000)))

n &lt;- as.numeric(999999999999999999999)

print(class(n))
```

### Logical
Use `logical` values for characteristics that are either `TRUE` or `FALSE`. Note that if `logical` elements can also have an `NA` value if the observation is missing. In the following examples, 

```{r}
# evaluate as logical, test whether 1 is greater than two
a &lt;- 1 &gt; 2
```

```{r}
# create two numerical values, one being NA, representing ages
age_john &lt;- 39
age_jane &lt;- NA

# logical NA from Jane&#39;s undefined age
(jo &lt;- age_john &gt; 50)
(ja &lt;- age_jane &gt; 50)
```

Logical values are often expressed in binary format as 0 = `FALSE` and ` = `TRUE`. in R these values are interconvertible. Other software (e.g., Excel, MS Access) may convert logical values to numbers that you do not expect.

```{r}
(t &lt;- as.logical(1))
(f &lt;- as.logical(0))
```

### Numeric
`Numeric` values are numbers with range about 2e-308 to 2e+308, depending on the computer you are using. You can see the possible range by entering `.Machine` at the R console. These can also include decimals. For more information, see [Double-precision floating-point format](https://en.wikipedia.org/wiki/Double-precision_floating-point_format)


### Integer
`Integer` values are numerical, but can only take on whole, rather than fractional values, and have a truncated range compared to `numeric`. For example, see below, if we try to create an integer that is out of range. The object we created is an integer, but because it is out of range, is value is set to `NA`.

```{r}
i &lt;- as.integer(999999999999999999999)

print(class(i))
```

### Complex
The `complex` type is used in mathematics and you are unlikely to use it in applied social science research unless you get into some heavy statistics. See [Complex number](https://en.wikipedia.org/wiki/Complex_number) for a full treatment.

### Character
`Character` data include the full set of keys on your keyboard that print out a character, typically [A-Z], [a-z], [0-9], punctuation, etc. The full set of ASCII characters is supported, e.g. the `accent aigu` in CafÃ©:

```{r}
print(class(&quot;CafÃ©&quot;))
```

Also numbers can function as characters. Be careful in converting between numerical and character versions. For example, see these ZIP codes:

```{r error=TRUE}
# this is a character
my_zip &lt;- &quot;98115&quot;

# it is not numeric.
my_zip + 2
```

```{r}
# we can convert it to numeric, although it would be silly to do with ZIP codes, which are nominal values
as.numeric(my_zip) + 2

# Boston has ZIP codes starting with zeros
boston_zip &lt;- &quot;02134&quot;
as.numeric(boston_zip)
```

### Raw
`Raw` values are used to store raw bytes in hexadecimal format. You are unlikely to use it in applied social science research. For example, the hexadecimal value for the character `z` is `7a`:

```{r}
print(charToRaw(&quot;z&quot;))

class(charToRaw(&quot;z&quot;))
```


## R data structures

![](images/week02/data_structures.png)

There are 5 basic data structures in R, as shown in the graphic: 

1. vector
1. matrix
1. array
1. list
1. data frame

In addition, the `factor` data type is very important

### Vector
A vector is an ordered set of elements of one or more elements of the same data type and are created using the `c()` constructor function. For example, a single value is a vector:

```{r}
# create a vector of length 1
a &lt;- 1
is(a)
```


If you try creating a vector with mixed data types, you may get unexpected results; mixing character elements with other type elements will result in character representations, e.g., 

```{r}
c(1, &quot;a&quot;, TRUE, charToRaw(&quot;z&quot;))
```

Results will depend on the data type you are mixing, for example because logical values can be expressed numerically, the `TRUE` and `FALSE` values are converted to `1` and `0`, respectively.

```{r}
(c(1:3, TRUE, FALSE))
```

But if a character is added, all elements are converted to characters.

```{r}
c(1:3, TRUE, FALSE, &quot;awesome!&quot;)
```

Order is important, i.e., 

`1, 2, 3` is not the same as `1, 3, 2`

R will maintain the order of elements in vectors unless a process is initiated that changes the order of those elements:

```{r}
# a vector 
(v &lt;- c(1, 3, 2))

(sort(v))
```

You can get some information about vectors, such as length and data type:

```{r}
# create a random normal 
set.seed(5)
normvec1000 &lt;- rnorm(n = 1000)

length(normvec1000)
class(normvec1000)
class(normvec1000 &gt; 1)
```

Elements of vectors are specified with their index number (1 .. n):

```{r}
v &lt;- seq(from = 0, to = 10, by = 2)
v[4]
```

### Matrix
A matrix is like a vector, in that it an contain only one data type, but it is two-dimensional, having rows and columns. A simple example:

```{r}
# make a vector 1 to 100
(v &lt;- 1:100)

# load to a matrix
(m1 &lt;- matrix(v, ncol = 10, byrow = TRUE))

# different r, c ordering
(m2 &lt;- matrix(v, ncol = 10, byrow = FALSE))
```

If you try to force a vector into a matrix whose row $\times$ col length does not match the length of the vector, the elements will be recycled, which may not be what you want. At least R will give you a warning.

```{r}
(m3 &lt;- matrix(letters, ncol = 10, nrow = 10))
```

### Array
An array is similar to matrix, but it can have more than one dimension. These can be useful for analyzing time series data or other multidimensional data. We will not be using array data in this course, but a simple example of creating and viewing the contents of an array:

```{r}
# a vector 1 to 27
v &lt;- 1:27

# create an array, 3 x 3 x 3
(a &lt;- array(v, dim = c(3, 3, 3)))

# array index is r, c, m (row, column, matrix), e.g., row 1 column 2 matrix 3:
(a[1,2,3])
```

### List
R lists are ordered collections of objects that do not need to be of the same data type. Those objects can be single-value vectors, multiple-value vectors, matrices, data frames, other lists, etc. Because of this, lists are a very flexible data type. But because they can have as little or as much structure as you want, can become difficult to manage and analyze.

Here is an example of a list comprised of single value vectors of different data type. Compare this with the attempt to make a vector comprised of elements of different data type:

```{r}
(l &lt;- list(&quot;a&quot;, 1, TRUE))
```

Let&#39;s modify that list a bit:

```{r}
(l &lt;- list(&quot;a&quot;, 
           1:20, 
           as.logical(c(0,1,1,0))))
```

The top-level indexing for a list is denoted using two sets of square brackets. For example, the first element of our list can be accessed by `l[[1]]`. For example, the mean of element 2 is obtained by `mean(l[[2]])`: ``r mean(l[[2]])``.

To perform operations on all elements of a list, use `lapply()`:

```{r}
# show the data types
(lapply(X = l, FUN = class))

# mean, maybe?
(lapply(X = l, FUN = function(x) {mean(x)}))
```
### Factor
Factors are similar to vectors, in that they are one-dimensional ordered sets. However, factors also use informational labels. For example, you may have a variable with household income as a text value:

* &quot;&lt;$10,000&quot;
* &quot;$10,000-$549,999&quot;
* &quot;$50,000-$99,999&quot;
* &quot;$100,000-$200,000&quot;
* &quot;&gt;$200,000&quot;

As a vector:

```{r}
(income &lt;- c(&quot;&lt;$10,000&quot;
, &quot;$10,000-$49,999&quot;
, &quot;$50,000-$99,999&quot;
, &quot;$100,000-$200,000&quot;
, &quot;&gt;$200,000&quot;))
```

Because these are characters, they do not sort in proper numeric order:

```{r}
sort(income)
```

If these are treated as a factor, the levels can be set for proper ordering:

```{r}
# create a factor from income and set the levels
(income_factor &lt;- factor(x = income, levels = income))

# sort again
(sort(income_factor))
```

As a factor, the data can also be used in statistical models and the magnitude of the variable will also be correctly ordered.

### Data frame
Other than vectors, data frames are probably the most used data type in R. You can think of data frames as matrices that allow columns with different data type. For example, you might have a data set that represents subject IDs as characters, sex or gender as text, height, weight, and age as numerical values, income as a factor, and smoking status as logical. Because a matrix requires only one data type, it would not be possible to store all of these as a matrix. An example:

```{r}
# income levels 
inc &lt;- c(&quot;&lt;$10,000&quot;
, &quot;$10,000-$49,999&quot;
, &quot;$50,000-$99,999&quot;
, &quot;$100,000-$200,000&quot;
, &quot;&gt;$200,000&quot;)

BMI &lt;-  data.frame(
   sid = c(&quot;A1001&quot;, &quot;A1002&quot;, &quot;B1001&quot;),
   gender = c(&quot;Male&quot;, &quot;Male&quot;,&quot;Female&quot;), 
   height_cm = c(152, 171.5, 165), 
   weight_kg = c(81, 93, 78),
   age_y = c(42, 38, 26),
   income = factor(c(&quot;$50,000-$99,999&quot;, &quot;$100,000-$200,000&quot;, &quot;&lt;$10,000&quot;), levels = inc)
)
print(BMI)
```

## tidyverse
This section will introduce some of the main workhorse functions in tidy data handling. 

Installing tidyverse is straightforward but it may take some time to download and install all of the packages. Use

```
install.packages(&quot;tidyverse&quot;)
```

For today&#39;s lesson we will be using one of the Add Health data sets, [AHwave1_v1.dta](data/AHwave1_v1.dta). 

```{r warning=FALSE}
# read the dta file
dat &lt;- readstata13::read.dta13(&quot;http://staff.washington.edu/phurvitz/csde502_winter_2021/data/AHwave1_v1.dta&quot;)
```

The data set includes variable labels, which make handling the data easier. Here we print the column names and their labels. Wrapping this in a `DT::data_table` presents a nice interface for showing only a few variables at a time and that allows sorting and searching.

```{r}
x &lt;- data.frame(colname = names(dat), label = attributes(dat)$var.labels)
DT::datatable(data = x, caption = &quot;Column names and labels in AHwave1_v1.dta.&quot;)
```


### magrittr{#magrittr}
![](images/week02/unepipe.jpeg)

The R package [`magrittr`](https://cran.r-project.org/web/packages/magrittr/index.html) allows the use of &quot;pipes&quot;. In UNIX, pipes were used to take the output of one program and to feed as input to another program. For example, the UNIX command `cat` prints the contents of a text file. This would print the contents of the file `00README.txt`:

```cat 00README.txt```

but with large files, the entire contents would scroll by too fast to read. Using a &quot;pipe&quot;, denoted with the vertical bar character `|` allowed using the `more` command to print one screen at a time by tapping the `Enter` key for each screen full of text:

```cat 00README.txt | more```

As shown in these two screen captures:

![](images/week02/cat_more.png)

![](images/week02/cat_more2.png)

The two main pipe operators we will use in `magrittr` are `%&gt;%` and &#39;%&lt;&gt;%&#39;.

`%&gt;%` is the pipe operator, which functions as a UNIX pipe, that is, to take something on the left hand side of the operator and feed it to the right hand side. 

`%&lt;&gt;%` is the assignment pipe operator, which takes something on the left hand side of the operator, feeds it to the right hand side, and replaces the object on the left-hand side.

For a simple example of the pipe, to list only the first 6 lines of a data frame in base R, we use `head()`, e.g.,

```{r}
head(iris)
```

using a tidy version of this:

```{r}
iris %&gt;% head()
```

In the R base version, we first read `head`, so we know we will be printing the first 6 elements of something, but we don&#39;t know what that &quot;something&quot; is. We have to read ahead to know we are reading the first 6 records of `iris`. In the tidy version, we start by knowing we are doing something to the data set, after which we know we are printing the first 6 records.

In base R functions, the process is evaluated from the inside out. For example, to get the mean sepal length of the _setosa_ species in iris, we would do this:

```{r}
mean(iris[iris$Species == &#39;setosa&#39;, &quot;Sepal.Length&quot;])
```

From the inside out, we read that we are making a subset of `iris` where Species = &quot;setosa&quot;, we are selecting the column &quot;Sepal.Length&quot;, and taking the mean. However, it requires reading from the inside out. For a large set of nested functions, we would have ` y &lt;- f(g(h((i(x)))))`, which would require first creating the innermost function (`i()`) and then working outward.

In a tidy approach this would be more like y &lt;- x %&gt;% i() %&gt;% h() %&gt;% g() %&gt;% f()` because the first function applied to the data set `x` is `i()`. Revisiting the mean sepal length of _setosa_ irises, example, under a tidy approach we would do this:

```{r}
iris %&gt;% filter(Species == &#39;setosa&#39;) %&gt;% summarise(mean(Sepal.Length))
```

Which, read from left to right, translates to &quot;using the iris data frame, make a subset of records where species is _setosa_, and summarize those records to get the mean value of sepal length.&quot; The tidy version is intended to be easier to write, read, and understand. The command uses the `filter()` function, which will be described below.

### Data subsetting (dplyr)
`dplyr` is the tidyverse R package used most frequently for data manipulation. Selection of records (i.e., subsetting) is done using logical tests to determine what is in the selected set. First we will look at logical tests and then we will cover subsetting rows and columns from data frames.

##### Logical tests
If elements meet a logical test, they will end up in the selected set. If data frame records have values in variables that meet logical criteria, the records will be selected. 

Some logical tests are shown below.

###### `==`: equals

```{r}
# numeric tests
(1 == 2)
```

```{r}
(1 == 3 - 2)
```

```{r}
# character test (actually a factor)
(dat$imonth %&gt;% head() %&gt;% str_c(collapse = &quot;, &quot;))
((dat$imonth == &quot;(6) June&quot;) %&gt;% head())
```

```{r}
# character test for multiple patterns
(dat$imonth %in% c(&quot;(6) June&quot;, &quot;(7) July&quot;) %&gt;% head())
```


###### `&gt;`, `&gt;=`, `&lt;`, `&lt;=`: numeric comparisons

```{r}
1 &lt; 2
```

```{r}
1 &gt; 2
```

```{r}
1 &lt;= -10:10
```

```{r}
1 &gt;= -10:10
```

###### `!=`: not equals

```{r}
1 != 2
```

```{r}
# those of the first 6 days that are not 14
(dat$iday %&gt;% head())
((dat$iday != 14) %&gt;% head())
```

###### `!`: invert, or &quot;not&quot;
Sometimes it is more convenient to negate a single condition rather than enumerating all possible matching conditions.

```{r}
dat$imonth %&gt;% head(20)
((!dat$imonth %in% c(&quot;(6) June&quot;, &quot;(7) July&quot;)) %&gt;% head(20))
```

#### Subset rows (`filter()`)
The `filter()` function creates a subset of records based on a logical test. Logical tests can be combined as &quot;and&quot; statements using the `&amp;` operator and &quot;or&quot; statements using the `|` operator. Here we will perform a few filters on a subset of the data.

```{r}
# first 20 records, fist 10 columns
dat_sub &lt;- dat[1:20, 1:10]
kable(dat_sub, format = &quot;html&quot;) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = F, position = &quot;left&quot;)
```

Records from one month:

```{r}
# from May
(dat_sub %&gt;% filter(imonth == &quot;(5) May&quot;))
```

Records from one month from females:

```{r}
(dat_sub %&gt;% filter(imonth == &quot;(5) May&quot; &amp; bio_sex == &quot;(2) Female&quot;))
```

Records from one month and from females or where the day of month was before the 15th, which will probably include some males:

```{r}
(dat_sub %&gt;% filter(imonth == &quot;(5) May&quot; &amp; (bio_sex == &quot;(2) Female&quot;) | iday &lt; 15))

```

Although these examples are silly and trivial, they show how `filter()` is used to create a selected set of data

#### Subset columns (`select()`)
A subset of columns can be extracted from data frames using the `select()` function, most simply using  named list of columns to keep.

```{r}
# select 3 columns
(dat_sub_sel &lt;- dat_sub %&gt;%   
    select(&quot;aid&quot;, &quot;imonth&quot;, &quot;iday&quot;))
```

```{r}
# select all but two named columns
(dat_sub_sel &lt;- dat_sub %&gt;%   
    select(-&quot;imonth&quot;, -&quot;iday&quot;))
```

```{r}
# select columns by position and whose name matches a pattern, in this case the regular expression &quot;^i&quot; meaning &quot;starts with lowercase i&quot;
(dat_sub_sel &lt;- dat_sub %&gt;%   
    select(1, matches(&quot;^i&quot;)))
```

`select()` can also be used to rename columns:

```{r}
#select one column, rename two columns
(dat_sub_sel %&gt;% 
   select(aid, Month = imonth, Day = iday))
```

Or column renaming can be done with `rename()`, which maintains all input data and only changes the named columns:

```{r}
(dat_sub_sel %&gt;% 
   rename(Month = imonth, Day = iday))
```

#### Subset rows and columns: `filter()` and `select()`
We can combine `filter()` and `select()` with a pipe to create a new data frame with a subset of rows and columns:

```{r}
# records with day of mongh &gt; 15 and the first 3 named columns
(x &lt;- dat_sub %&gt;% 
    filter(iday &gt; 15) %&gt;%
    select(aid, imonth, iday)
   )
```

#### Create or calculate columns: `mutate()`
`mutate()` will create new named columns or re-calculate existing columns. Here we will make a column that stratifies birth month, with the cut at June. 

Although the birth month column (`h1gi1m`) is a factor, it is unordered, so we need to make it ordered before using the factor label in a numeric comparison. Fortunately, the factor labels were handled in correct order:

```{r}
# is this ordered?
is.ordered(dat$h1gi1m)
```

```{r}
# what are the levels?
(levels(dat$h1gi1m))
```

Assign order, create a new column, and print nicely:

```{r}
# make birth month ordered
dat$h1gi1m &lt;- factor(dat$h1gi1m, ordered = TRUE)

# now is it ordered?
is.ordered(dat$h1gi1m)
```

```{r}
# perform the mutate() using the string representation of the factor for comparison
dat %&gt;% 
    filter(iday &gt; 15) %&gt;%
    select(aid, imonth, iday, birth_month = h1gi1m) %&gt;% 
    mutate(birth_1st_half = (birth_month &lt; &quot;(7) July&quot;)) %&gt;% 
    head(20) %&gt;% 
    kable() %&gt;% 
    kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = F, position = &quot;left&quot;)
```

A silly example but showing that `mutate()` can change values of existing columns:

```{r}
(X &lt;- dat_sub %&gt;% 
     mutate(iday = -1000 + iday))
```

... so do be careful!

Other functions can be used with mutate include (but are by no means limited to!) 

* `if_else()`: create a column by assigning values based on logical criteria
* `case_when()`: similar to `if_else()` but for multiple input values
* `recode()`: change particular values

When we recoded the birth month, the output was a `logical` data type. If we wanted to create a 
`character` or `factor`, we could use `if_else()`. Here we are creating a new data frame based on several operations on `dat`.

```{r}
dat_1 &lt;- dat %&gt;% 
    filter(iday &gt; 15) %&gt;%
    head(20) %&gt;%
    select(aid, imonth, iday, birth_month = h1gi1m) %&gt;% 
    mutate(birth_year_half = ifelse(test = birth_month &lt; &quot;(7) July&quot;, yes = &quot;first&quot;, no = &quot;last&quot;))

# make that a factor
dat_1$birth_year_half &lt;- factor(dat_1$birth_year_half, levels = c(&quot;first&quot;, &quot;last&quot;))
    
# print
kable(dat_1) %&gt;% 
    kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = F, position = &quot;left&quot;)
```

If one of your variables contains multiple values and you want to create classes, use `case_when()`. Here is a verbose example stratifying months into quarters. Also we are using the `magrittr` assignment pipe to update the input based on the statement, i.e., `dat_1` will change based on the commands we use. __Be careful using the assignment pipe because it will change your data frame.__

`case_when()` will recode in order or the way the command is written, so for months and quarters, it is not necessary to specify both ends of the quarter. Also any cases that are not explicitly handled can be addressed with the `TRUE ~ ...` argument; in this case, any records that had birth months that were not before September get assigned to quarter 4.

```{r}
dat_1 %&lt;&gt;% 
    mutate(quarter = case_when(
        birth_month &lt; &quot;(3) March&quot; ~ 1,
        birth_month &lt; &quot;(6) June&quot; ~ 2,
        birth_month &lt; &quot;(9) September&quot; ~ 3,
        TRUE ~ 4))

# print
kable(dat_1) %&gt;% 
    kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = F, position = &quot;left&quot;)
```

`recode()` is used to change the `birth_year_half` column:

```{r}
(dat_1 %&lt;&gt;% 
     mutate(birth_year_half_split = recode(birth_year_half,
                   &quot;first&quot; = &quot;early&quot;,
                   &quot;last&quot; = &quot;late&quot;)))
```

#### Summarizing/aggregating data
We will spend more time later in the course on data summaries, but an introduction with `dplyr` is worthwhile introducing at this stage. The two main functions are `summarise()` and `group_by()`.

A simple summary will tabulate the count of respondents and the mean age. The filter `! str_detect(h1gi1y, &quot;Refused&quot;)` drops records from respondents who refused to give their birth year.

```{r}
dat %&gt;% 
    filter(! str_detect(h1gi1y, &quot;Refused&quot;)) %&gt;% 
    mutate(yeari = str_replace_all(iyear, &quot;.* &quot;, &quot;&quot;) %&gt;% as.integer(),
           yearb = str_replace_all(h1gi1y, &quot;.* &quot;, &quot;&quot;) %&gt;% as.integer()) %&gt;% 
    summarise(n = n(),
              mean_age = mean(yeari - yearb))
```

Here we will summarize age by sex using the `group_by()` function, and also piping to `prop_table()` to get the percentage:

```{r}
dat %&gt;% 
    filter(! str_detect(h1gi1y, &quot;Refused&quot;)) %&gt;% 
    mutate(yeari = str_replace_all(iyear, &quot;.* &quot;, &quot;&quot;) %&gt;% as.integer(),
           yearb = str_replace_all(h1gi1y, &quot;.* &quot;, &quot;&quot;) %&gt;% as.integer()) %&gt;% 
    group_by(bio_sex) %&gt;% 
    summarise(mean_age = mean(yeari - yearb),
              sd_age = sd(yeari - yearb),
              n = n(),
              .groups = &quot;drop_last&quot;) %&gt;% 
    mutate(pct = prop.table(n) * 100)
```


&lt;h4&gt;Source code for this document&lt;/h4&gt;
[02-week02.Rmd](01-week02.Rmd)

```{r, comment=&#39;&#39;, echo=FALSE}
cat(readLines(&quot;02-week02.Rmd&quot;), sep = &#39;\n&#39;)
```</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-week02.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
